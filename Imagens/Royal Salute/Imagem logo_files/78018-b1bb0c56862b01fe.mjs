(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[78018],{337148:e=>{var t,i,n={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaOnIdeaPinPermissionQuery",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"v3GetCurrentUserHandlerQuery",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"data",plural:!1,selections:[t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"ipStelaRecDisabled",storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],type:"V3GetCurrentUserHandler",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"StelaOnIdeaPinPermissionQuery",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"v3GetCurrentUserHandlerQuery",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"data",plural:!1,selections:[i,t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Node",abstractKey:"__isNode"}],storageKey:null}],type:"V3GetCurrentUserHandler",abstractKey:null}],storageKey:null}]},params:{cacheID:"f6e0b195a5e1e15958602eecc2c94dba",id:null,metadata:{},name:"StelaOnIdeaPinPermissionQuery",operationKind:"query",text:"query StelaOnIdeaPinPermissionQuery {\n  v3GetCurrentUserHandlerQuery {\n    __typename\n    ... on V3GetCurrentUserHandler {\n      data {\n        __typename\n        ... on User {\n          ipStelaRecDisabled\n        }\n        ... on Node {\n          __isNode: __typename\n          id\n        }\n      }\n    }\n  }\n}\n"}};n.hash="c061d1400492f868408772f86f659738",e.exports=n},701305:e=>{var t=[],i=[];function n(e,t,i,s){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var o=Object.prototype.toString,r=o.call(e);if(r!=o.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return!isNaN(e)&&!isNaN(t)&&e==Number(t);case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}for(var l=i.length;l--;)if(i[l]==e)return s[l]==t;i.push(e),s.push(t);var a=0;if("[object Array]"===r){if((a=e.length)!==t.length)return!1;for(;a--;)if(!n(e[a],t[a],i,s))return!1}else{if(e.constructor!==t.constructor)return!1;if(e.hasOwnProperty("valueOf")&&t.hasOwnProperty("valueOf"))return e.valueOf()==t.valueOf();var d=Object.keys(e);if(d.length!=Object.keys(t).length)return!1;for(var c=0;c<d.length;c++)if(!n(e[d[c]],t[d[c]],i,s))return!1}return i.pop(),s.pop(),!0}e.exports=function(e,s){var o=t.length?t.pop():[],r=i.length?i.pop():[],l=n(e,s,o,r);return o.length=0,r.length=0,t.push(o),i.push(r),l}},60139:e=>{function t(e){return function(){return e}}var i=function(){};i.thatReturns=t,i.thatReturnsFalse=t(!1),i.thatReturnsTrue=t(!0),i.thatReturnsNull=t(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(e){return e},e.exports=i},663620:(e,t,i)=>{var n=i(60139);e.exports=n},989881:(e,t,i)=>{var n=i(247816),s=i(899291)(n);e.exports=s},247816:(e,t,i)=>{var n=i(228483),s=i(3674);e.exports=function(e,t){return e&&n(e,t,s)}},702958:(e,t,i)=>{var n=i(646384),s=i(690939);e.exports=function(e,t,i,o){var r=i.length,l=r,a=!o;if(null==e)return!l;for(e=Object(e);r--;){var d=i[r];if(a&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++r<l;){var c=(d=i[r])[0],u=e[c],h=d[1];if(a&&d[2]){if(void 0===u&&!(c in e))return!1}else{var _=new n;if(o)var p=o(u,h,c,e,t,_);if(!(void 0===p?s(h,u,3,o,_):p))return!1}}return!0}},267206:(e,t,i)=>{var n=i(191573),s=i(716432),o=i(406557),r=i(701469),l=i(139601);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?r(e)?s(e[0],e[1]):n(e):l(e)}},269199:(e,t,i)=>{var n=i(989881),s=i(498612);e.exports=function(e,t){var i=-1,o=s(e)?Array(e.length):[];return n(e,(function(e,n,s){o[++i]=t(e,n,s)})),o}},191573:(e,t,i)=>{var n=i(702958),s=i(301499),o=i(542634);e.exports=function(e){var t=s(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(i){return i===e||n(i,e,t)}}},716432:(e,t,i)=>{var n=i(690939),s=i(227361),o=i(379095),r=i(115403),l=i(689162),a=i(542634),d=i(240327);e.exports=function(e,t){return r(e)&&l(t)?a(d(e),t):function(i){var r=s(i,e);return void 0===r&&r===t?o(i,e):n(t,r,3)}}},882689:(e,t,i)=>{var n=i(829932),s=i(297786),o=i(267206),r=i(269199),l=i(571131),a=i(307518),d=i(285022),c=i(406557),u=i(701469);e.exports=function(e,t,i){t=t.length?n(t,(function(e){return u(e)?function(t){return s(t,1===e.length?e[0]:e)}:e})):[c];var h=-1;t=n(t,a(o));var _=r(e,(function(e,i,s){return{criteria:n(t,(function(t){return t(e)})),index:++h,value:e}}));return l(_,(function(e,t){return d(e,t,i)}))}},840371:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},379152:(e,t,i)=>{var n=i(297786);e.exports=function(e){return function(t){return n(t,e)}}},571131:e=>{e.exports=function(e,t){var i=e.length;for(e.sort(t);i--;)e[i]=e[i].value;return e}},626393:(e,t,i)=>{var n=i(733448);e.exports=function(e,t){if(e!==t){var i=void 0!==e,s=null===e,o=e==e,r=n(e),l=void 0!==t,a=null===t,d=t==t,c=n(t);if(!a&&!c&&!r&&e>t||r&&l&&d&&!a&&!c||s&&l&&d||!i&&d||!o)return 1;if(!s&&!r&&!c&&e<t||c&&i&&o&&!s&&!r||a&&i&&o||!l&&o||!d)return-1}return 0}},285022:(e,t,i)=>{var n=i(626393);e.exports=function(e,t,i){for(var s=-1,o=e.criteria,r=t.criteria,l=o.length,a=i.length;++s<l;){var d=n(o[s],r[s]);if(d)return s>=a?d:d*("desc"==i[s]?-1:1)}return e.index-t.index}},899291:(e,t,i)=>{var n=i(498612);e.exports=function(e,t){return function(i,s){if(null==i)return i;if(!n(i))return e(i,s);for(var o=i.length,r=t?o:-1,l=Object(i);(t?r--:++r<o)&&!1!==s(l[r],r,l););return i}}},301499:(e,t,i)=>{var n=i(689162),s=i(3674);e.exports=function(e){for(var t=s(e),i=t.length;i--;){var o=t[i],r=e[o];t[i]=[o,r,n(r)]}return t}},689162:(e,t,i)=>{var n=i(513218);e.exports=function(e){return e==e&&!n(e)}},542634:e=>{e.exports=function(e,t){return function(i){return null!=i&&(i[e]===t&&(void 0!==t||e in Object(i)))}}},139601:(e,t,i)=>{var n=i(840371),s=i(379152),o=i(115403),r=i(240327);e.exports=function(e){return o(e)?n(r(e)):s(e)}},189734:(e,t,i)=>{var n=i(121078),s=i(882689),o=i(105976),r=i(816612),l=o((function(e,t){if(null==e)return[];var i=t.length;return i>1&&r(e,t[0],t[1])?t=[]:i>2&&r(t[0],t[1],t[2])&&(t=[t[0]]),s(e,n(t,1),[])}));e.exports=l},619983:(e,t,i)=>{i.d(t,{e:()=>r,v:()=>l});var n=i(441143),s=i.n(n);class o{constructor(e,t){s()(e,"You must pass a requestContext to check an Experiment"),s()(t,"You must pass the name of the experiment to check"),this.requestContext=e,this.experimentName=t.toLowerCase()}_getGroup(e){return e?this.requestContext.experiments.v2ActivateExperiment(this.experimentName)||"":this.requestContext.experiments.v2GetGroup(this.experimentName)||""}}class r extends o{getGroup(e=!1){return this._getGroup(e)}}class l extends o{_isTreatment(e){return e.startsWith("enabled")||e.startsWith("employee")}enabled(){return this._isTreatment(this._getGroup(!0))}enabledWithNoActivation(){return this._isTreatment(this._getGroup(!1))}}},678691:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(448272),s=i(263116),o=i(785893);const r=(0,s.ZP)({resolved:{},chunkName:()=>"EditorWithMentionsInternal",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!i.m[t]},importAsync:()=>Promise.all([i.e(89333),i.e(35978)]).then(i.bind(i,497e3)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return i(t)},resolve(){return 497e3}});function l(e){return(0,o.jsx)(r,{...e,fallback:(0,o.jsx)(n.Z,{})})}},448272:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(898781),s=i(883119),o=i(785893);function r(){const e=(0,n.ZP)();return(0,o.jsx)(s.kC,{alignItems:"center",justifyContent:"center",children:(0,o.jsx)(s.$j,{accessibilityLabel:e._('Loading editor', 'EditorWithMentionsFallback.loading', 'Message shown while waiting for the editor to load'),show:!0})})}},194866:(e,t,i)=>{i.d(t,{Z:()=>o});var n=i(883119),s=i(785893);function o(e){const{htmlFor:t,errorMessage:i}=e;return(0,s.jsx)(n.__,{htmlFor:t,children:(0,s.jsx)(n.xu,{marginTop:1,children:(0,s.jsx)(n.xv,{color:"error",size:"200",children:i})})})}},879089:(e,t,i)=>{i.d(t,{Z:()=>P});var n=i(667294),s=i(966338),o=i(693456),r=i(978674),l=i(47246),a=i(223123),d=i(717615),c=i(784590),u=i(19121),h=i(957119),_=i(108391),p=i(231947),g=i(414327),m=i(898781),x=i(883119),f=i(785893);function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y({board:e,hovered:t,searchQuery:i}){const n=e.privacy===r.Z.BoardPrivacy.SECRET;return(0,f.jsxs)(x.xu,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:[(0,f.jsx)(x.xu,{flex:"grow",children:(0,f.jsx)(x.xv,{weight:"bold",children:(0,_.W)(i,e.name)})}),(0,f.jsxs)(x.kC,{alignItems:"stretch",justifyContent:"start",direction:"row",flex:"none",children:[n&&(0,f.jsx)(o.Z,{type:"secret"}),e.is_collaborative&&(0,f.jsx)(o.Z,{type:"group"})]})]})}class b extends n.Component{constructor(e){super(e),v(this,"getSections",(()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return[];const{searchQuery:t}=this.state,{boardResource:{data:{all_boards:i}}}=this.props;return t.length>=2?[{items:(0,h.j)(i,t)}]:[{items:i}]})),v(this,"createBtnDisabled",(()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return!1;const{boardResource:{data:{all_boards:t}}}=this.props,{searchQuery:i}=this.state;return t.some((e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase()}))})),v(this,"handleBoardCreate",(e=>()=>{const{searchQuery:e}=this.state;if(!e)return;const{createBoard:t,invalidateBoardPickerBoardsResource:i,onBoardCreate:n}=this.props;i(),n?n(e):t({name:e,privacy:"public"}).then((e=>{const{onBoardChosen:t}=this.props;t(e)}))})),v(this,"handleBoardSelected",(e=>{this.props.onBoardChosen(e),this.setState({selectedBoard:e})})),v(this,"handleSearchQueryUpdate",(e=>{this.setState({searchQuery:e})})),v(this,"renderRow",(({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return(0,f.jsx)(y,{board:e,hovered:t,searchQuery:i})})),this.state={searchQuery:"",selectedBoard:e.board}}render(){const{boardResource:e,board:t,isBoardlessPinsBoard:i,isQuickCreatesBoard:n,isStoryPin:s,viewer:o}=this.props,{searchQuery:r,selectedBoard:a}=this.state;let d=this.props.i18n._('Select a board', 'Label for selecting a board in Edit Pin Modal', 'Label for selecting a board in Edit Pin Modal');return t?d=n?this.props.i18n._('Choose board', 'BoardPickerFlyout.displayBoardName.quickCreatesBoard', 'Title for board picker when current board is a quick creates board'):i?this.props.i18n._('Profile', 'BoardPickerFlyout.displayBoarName.boardlessPins', 'Title indicating the pin is saved to profile'):t.name:a&&(d=a.name),(0,f.jsxs)(x.xu,{children:[(0,f.jsx)(x.$j,{accessibilityLabel:this.props.i18n._('loading board picker', 'accessibility text for loading spinner', 'accessibility text for loading spinner'),show:!e.isLoaded}),e.data&&(0,f.jsx)(l.Z,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:d||"",isStoryPin:s,onCreate:this.handleBoardCreate(o),onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleBoardSelected,renderRow:this.renderRow,searchQuery:r,sections:this.getSections()})]})}}function P(e){const t=(0,a.Z)(),i=(0,m.ZP)(),n=(0,s.useDispatch)(),o=(0,u.Z)(),r=(0,s.useSelector)((({advertiser:e})=>e)),l=o.isAuth&&r&&r.owner_user_id!==o.id,h=l?r.id:null,_=l?r.owner_user_id:null,x=(0,d.Z)(),v=(0,p.Ms)(o,x),y=v||_,P=(0,c.Z)({name:"BoardPickerBoardsResource",options:{pin_id:e.pinId,field_set_key:"board_picker",onlyFetchBoards:!0,username:y,...h&&_?{advertiser_id:h,filter:"protected",username:_}:{}},noCache:!0});return(0,f.jsx)(b,{...e,advertiser_id:h,boardResource:P,createBoard:e=>t({boardCreateOptions:e}),invalidateBoardPickerBoardsResource:()=>{n((0,g.jB)("BoardPickerBoardsResource",{field_set_key:"board_picker",...v?{username:v}:{username:_}}))},username:_,viewer:o,i18n:i})}},47246:(e,t,i)=>{i.d(t,{Z:()=>_});var n=i(667294),s=i(470623),o=i(139176),r=i(603174),l=i(887831),a=i(898781),d=i(883119),c=i(785893);function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends n.Component{constructor(...e){super(...e),u(this,"state",{showFlyout:!1}),u(this,"setContainerRef",(e=>{this.containerRef=e})),u(this,"handleCreate",(()=>{this.hideFlyout();const{onCreate:e}=this.props;e&&e()})),u(this,"handleSelectItem",(e=>{this.hideFlyout();const{onSelect:t,onCreate:i}=this.props;e?t(e):i&&i()})),u(this,"handleDropdownTouch",(()=>{this.setState((e=>({showFlyout:!e.showFlyout})))})),u(this,"handleHideFlyout",(e=>{this.containerRef&&e.target instanceof HTMLElement&&!this.containerRef.contains(e.target)&&this.hideFlyout()})),u(this,"hideFlyout",(()=>{const{hoverHandlers:{onMouseLeave:e}}=this.props;e(),this.setState({showFlyout:!1})}))}componentDidMount(){document.addEventListener("click",this.handleHideFlyout,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleHideFlyout,{capture:!0})}render(){const{dropdownValue:e,fetchMore:t,hoverHandlers:{onMouseOver:i,onMouseLeave:n},isHovering:l,isStoryPin:a,onCreate:u,onSearchQueryUpdate:h,renderRow:_,searchQuery:p,sections:g,createBtnDisabled:m}=this.props,{showFlyout:x}=this.state;this.indexManager=new s.Z(g.map((e=>e.items))),this.indexManager.setSelectItem(this.handleSelectItem);const f=!p.trim()||!!m;return(0,c.jsxs)(d.xu,{ref:this.setContainerRef,flex:a?"grow":void 0,children:[(0,c.jsx)(d.iP,{fullWidth:!!a,onMouseEnter:i,onMouseLeave:n,onTap:this.handleDropdownTouch,rounding:2,children:(0,c.jsxs)(d.xu,{alignItems:"center",color:l?"lightWash":"lightGray",direction:"row",display:"flex",flex:"grow",paddingX:4,paddingY:a?4:3,rounding:a?4:2,children:[(0,c.jsx)(d.kC,{alignItems:"stretch",justifyContent:"start",flex:"grow",children:(0,c.jsx)(d.xv,{weight:"bold",children:e})}),(0,c.jsx)(d.JO,{accessibilityLabel:"",color:"default",icon:"arrow-down",size:14})]})}),x&&(0,c.jsx)(d.xu,{position:"relative",children:(0,c.jsxs)(d.xu,{borderStyle:"sm",color:"white",direction:"column",display:"flex",overflow:"hidden",position:"absolute",rounding:a?4:2,width:"100%",zIndex:new d.Ry(1),children:[(0,c.jsx)(d.xu,{children:(0,c.jsxs)(d.xu,{display:"flex",marginStart:-1,marginEnd:-1,padding:2,children:[(0,c.jsx)(d.xu,{display:"flex",flex:"grow",paddingX:1,children:(0,c.jsx)(o.Z,{hideIcon:!0,indexManager:this.indexManager,onChange:h,value:p})}),u&&(0,c.jsx)(d.xu,{paddingX:1,children:(0,c.jsx)(d.zx,{disabled:f,onClick:this.handleCreate,text:this.props.i18n._('Create', 'board or section dropdown create button', 'board or section dropdown create button')})})]})}),(0,c.jsx)(r.Z,{fetchMore:t,indexManager:this.indexManager,maxHeight:240,onSelectItem:this.handleSelectItem,renderItem:_,sections:g})]})})]})}}function _(e){const t=(0,a.ZP)(),{isHovering:i,hoverHandlers:n}=(0,l.Z)();return(0,c.jsx)(h,{...e,i18n:t,isHovering:i,hoverHandlers:n})}},316298:(e,t,i)=>{i.d(t,{Z:()=>f,x:()=>x});var n=i(667294),s=i(966338),o=i(4392),r=i(47246),l=i(784590),a=i(957119),d=i(108391),c=i(898781),u=i(883119),h=i(785893);function _(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p="NO_SECTION_VALUE";function g({section:e,hovered:t,searchQuery:i}){return(0,h.jsxs)(u.xu,{children:[(0,h.jsx)(u.xu,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:(0,h.jsx)(u.xu,{flex:"grow",children:(0,h.jsx)(u.xv,{weight:"bold",children:(0,d.W)(i,e.title)})})}),e.id===p&&(0,h.jsx)(u.iz,{})]})}class m extends n.Component{constructor(...e){super(...e),_(this,"state",{searchQuery:""}),_(this,"getPickerSections",(()=>{const{searchQuery:e}=this.state,{sectionsResource:t,mergingFromSectionId:i}=this.props;let n=t&&t.data||[];return n=i?n.filter((e=>e.id!==i)):[{id:p,title:this.props.i18n._('No section', 'default dropdown option for selecting a board section on pin edit', 'default dropdown option for selecting a board section on pin edit')},...n],e.length>=2&&(n=(0,a.j)(n,e,"title")),[{items:n}]})),_(this,"createBtnDisabled",(()=>{const{sectionsResource:e}=this.props,{searchQuery:t}=this.state;return!(!e||!e.data)&&e.data.some((e=>{var i;return(null===(i=e.title)||void 0===i?void 0:i.toLowerCase())===t.toLocaleLowerCase()}))})),_(this,"handleSectionCreate",(()=>{const{board:e,onSectionChange:t,sectionsResource:i,dispatch:n,onSectionCreate:s}=this.props,{searchQuery:r}=this.state;s?s(r):n&&e.id&&n((0,o.Z)({boardId:e.id,name:r},this.props.i18n)).then((e=>{i&&i.refresh(),this.setState({searchQuery:""}),t(e)}))})),_(this,"handleSectionSelected",(e=>{const{onSectionChange:t}=this.props;e.id===p?(t(null),this.setState({searchQuery:""})):(t(e),this.setState({searchQuery:""}))})),_(this,"handleSearchQueryUpdate",(e=>{this.setState({searchQuery:e})})),_(this,"renderRow",(({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return(0,h.jsx)(g,{hovered:t,searchQuery:i,section:e})}))}componentDidUpdate(e){const t=e.selectedSectionId,{selectedSectionId:i}=this.props;if(i!==t){const{sectionsResource:e}=this.props;e&&e.refresh()}}render(){const{isStoryPin:e,sectionsResource:t,selectedSectionId:i,mergingFromSectionId:n,selectedSectionName:s}=this.props,{searchQuery:o}=this.state;let l=n?this.props.i18n._('Pick a section', 'default dropdown option for selecting a board section to merge to', 'default dropdown option for selecting a board section to merge to'):this.props.i18n._('No section', 'default dropdown option for selecting a board section on pin edit', 'default dropdown option for selecting a board section on pin edit');if(i){let e;t&&t.data&&(e=t.data.find((e=>e.id===i))),l=e&&e.title||l}else s&&(l=s);return(0,h.jsxs)(u.xu,{children:[(0,h.jsx)(u.$j,{accessibilityLabel:this.props.i18n._('loading section picker', 'accessibility text for loading spinner', 'accessibility text for loading spinner'),show:!!t&&!t.isLoaded}),(!t||t&&t.isLoaded)&&(0,h.jsx)(r.Z,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:l,isStoryPin:e,onCreate:n?null:this.handleSectionCreate,onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleSectionSelected,renderRow:this.renderRow,searchQuery:o,sections:this.getPickerSections()})]})}}function x(e){const t=(0,c.ZP)();return(0,h.jsx)(m,{...e,dispatch:(0,s.useDispatch)(),i18n:t})}function f(e){const t=(0,l.Z)({name:"BoardSectionsRepinResource",options:{board_id:e.board.id},noCache:!0});return(0,h.jsx)(x,{...e,sectionsResource:t})}},842057:(e,t,i)=>{i.r(t),i.d(t,{CarouselSliders:()=>_,default:()=>p});var n=i(966338),s=i(333070),o=i(834911),r=i(898781),l=i(811403),a=i(890473),d=i(407043),c=i(883119),u=i(785893);const h={slider:{cursor:"pointer",padding:"30px 16px",position:"relative",zIndex:"105",pointerEvents:"auto"}},_=({addEllipsis:e,carouselIndex:t,carouselData:i,changeCarouselSlotIndex:n,handleCarouselSwipe:o,isShowingLastSlide:l,pin:_,pinId:p,contextLogData:g,viewParameter:m,viewType:x,componentType:f,isEditMode:v,forwardNode:y,backNode:b})=>{const P=(0,r.ZP)(),{logContextEvent:j}=(0,d.v)();if(!i)return null;const{carousel_slots:C=[],index:S=0}=i,w=void 0!==t?t:S,A=Math.max(0,w-1),z=Math.min(C.length-1,w+1),k=0===w,E=l||w===C.length-1,I=(e,t)=>{((e,t,i,n,s,o)=>{o||void 0===n||(e.preventDefault(),e.stopPropagation(),n(t,i)),void 0!==s&&s(i)})(e,p,t,n,o,v),((e,t,i,n,s,o,r,l,d,c,u)=>{if(!u||!o){const{carousel_slots:u,id:h}=o;e({event_type:108,object_id_str:i,component:d,view_type:l,view_parameter:r,event_data:{pinCarouselSlotEventData:{carouselSlotId:(null==u?void 0:u[n])&&Number(u[n].id),carouselDataId:Number(h),carouselSlotIndex:n,toCarouselSlotIndex:s}},aux_data:{...c,...(0,a.Kl)(t)||{}}})}})(j,_,p,w,t,i,m,x,f,g,v)};return(0,u.jsxs)(c.xu,{display:"flex",justifyContent:"between",position:"absolute",alignItems:"center",left:!0,right:!0,bottom:!0,top:!0,children:[(0,u.jsx)("div",{"data-test-id":"carousel-slider-left",role:"presentation",onClick:e=>{I(e,A)},onKeyUp:e=>{I(e,A)},style:h.slider,children:(0,u.jsx)(c.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{visibility:k?"hidden":"visible"}},display:"flex",height:"100%",justifyContent:"center",width:"100%",children:b||(0,u.jsx)(c.JO,{color:"white",icon:"arrow-back",accessibilityLabel:P._('View Previous', 'Button to advance carousel to the previous image', 'Button to advance carousel to the previous image')})})}),e&&(0,u.jsx)(s.default,{pinId:p,carouselIndex:t,carouselData:i,handleCarouselSwipe:o,variant:"default"}),(0,u.jsx)("div",{"data-test-id":"carousel-slider-right",role:"presentation",onClick:e=>{I(e,z)},onKeyUp:e=>{I(e,z)},style:h.slider,children:(0,u.jsx)(c.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{visibility:E?"hidden":"visible"}},display:"flex",height:"100%",justifyContent:"center",width:"100%",children:y||(0,u.jsx)(c.JO,{color:"white",icon:"arrow-forward",accessibilityLabel:P._('View Next', 'Button to advance carousel to the next image', 'Button to advance carousel to the next image')})})})]})},p=(0,n.connect)((({pins:e},{carouselData:t,pinId:i})=>{const n=e[i];return{pin:n,carouselData:t||(0,o.Z)({pin:n})}}),(e=>({changeCarouselSlotIndex:(t,i)=>e((0,l.yR)(t,i))})))(_)},914166:(e,t,i)=>{i.d(t,{ZP:()=>Ne,Tr:()=>Be,aU:()=>De});var n=i(667294),s=i(966338),o=i(838292),r=i(150361),l=i.n(r),a=i(898781),d=i(883119),c=i(785893);function u({commentsDisabled:e,onCommentChange:t,onPhotoChange:i,photosDisabled:n,isManagedView:s,isNoTitle:o}){const r=(0,a.ZP)(),l=s?6:o?0:3;return(0,c.jsxs)(d.xu,{children:[!o&&(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:s?0:4,paddingY:l,children:[!s&&!o&&(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",children:r._('Comment Permissions', 'Label for comments setting on a pin in pin edit form', 'Label for comments setting on a pin in pin edit form')})}),(0,c.jsxs)(d.xu,{column:12,mdColumn:s?12:8,children:[(0,c.jsxs)(d.xu,{paddingY:1,display:"flex",alignItems:"center","data-test-id":"allow-comments-switch",children:[(0,c.jsx)(d.rs,{onChange:t,id:"CommentSwitch",switched:!e}),(0,c.jsx)(d.xu,{paddingX:2,children:(0,c.jsx)(d.__,{htmlFor:"CommentSwitch",children:(0,c.jsx)(d.xv,{size:"200",children:r._('Allow people to comment', 'Label for toggling comments on a pin in pin edit form', 'Label for toggling comments on a pin in pin edit form')})})})]}),i&&(0,c.jsxs)(d.xu,{paddingY:1,alignItems:"center",display:"flex",children:[(0,c.jsx)(d.rs,{onChange:i,id:"PhotoSwitch",switched:!n}),(0,c.jsx)(d.xu,{paddingX:2,children:(0,c.jsx)(d.__,{htmlFor:"PhotoSwitch",children:(0,c.jsx)(d.xv,{size:"200",children:r._('Allow people to upload photos', 'Label for toggling photos on a pin in pin edit form', 'Label for toggling photos on a pin in pin edit form')})})})]})]})]})]})}var h=i(978674),_=i(310204),p=i(6637),g=i(414327);var m=i(4392),x=i(618446),f=i.n(x),v=i(121151),y=i(756777),b=i(941646),P=i(499128),j=i(343341);function C(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class S extends n.PureComponent{constructor(...e){super(...e),C(this,"state",{deleting:!1}),C(this,"unmounted",!1),C(this,"handleConfirm",(()=>{if(this.state.deleting)return;const{onDeletePin:e}=this.props;this.setState({deleting:!0}),e().then((()=>this.handleDeleteDidComplete())).catch((e=>this.handleDeleteDidComplete(e)))})),C(this,"handleDeleteDidComplete",(e=>{const{toastManagerContext:t}=this.props;this.unmounted||this.setState({deleting:!1}),e||t.showToast((({hideToast:e})=>(0,c.jsx)(P.ZP,{onHide:e,text:this.props.i18n._('Pin deleted!', 'User deleted their pin', 'User deleted their pin')})))}))}componentWillUnmount(){this.unmounted=!0}render(){const{i18n:e,onDismiss:t,showStoryPinCreatorDeleteMessage:i}=this.props,{deleting:n}=this.state;return(0,c.jsx)(v.ZP,{heading:e._('Are you sure?', 'Confirm the user wants to delete the pin', 'Confirm the user wants to delete the pin'),accessibilityModalLabel:e._('Are you sure you want to delete this pin?', 'Accessible label to confirm the user wants to delete the pin', 'Accessible label to confirm the user wants to delete the pin'),size:"sm",onDismiss:t,footer:(0,c.jsxs)(d.xu,{display:"flex",justifyContent:"center",marginStart:-1,marginEnd:-1,children:[(0,c.jsx)(d.xu,{paddingX:1,children:(0,c.jsx)(d.zx,{fullWidth:!0,onClick:t,text:e._('Cancel', ' - ', ' -- ')})}),(0,c.jsx)(d.xu,{paddingX:1,children:(0,c.jsx)(b.Z,{id:"confirm-delete-pin",children:(0,c.jsx)(y.Z,{color:"red",onClick:this.handleConfirm,text:e._('Delete', 'PinEditModal.DeletePinConfirmation.DeleteButton', 'Delete button to delete a Pin'),submitting:n})})})]}),children:(0,c.jsx)(d.xu,{padding:4,children:(0,c.jsx)(d.xv,{children:i?e._('If you delete this Pin, it\'ll be gone for good and those who\'ve saved it won\'t be able to view it.', 'PinEditModal.DeletePinConfirmation', 'Confirmation to delete a Pin that lets the creator know it will be unavailable to other Pinners who have saved it'):e._('Once you delete a Pin, you can\'t undo it!', ' - ', ' -- ')})})})}}function w(e){const t=(0,a.ZP)();return(0,c.jsx)(S,{...e,i18n:t,toastManagerContext:(0,j.F9)()})}function A({canEdit:e,onAltTextChange:t,altText:i}){const s=(0,a.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"AltTextField",children:(0,c.jsx)(d.xv,{size:"200",children:s._('Alt text', 'EditPinModal.EditAltText', 'Label for editing alt text of pin')})})}),(0,c.jsx)(d.xu,{column:12,mdColumn:8,children:e?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.xu,{children:(0,c.jsx)(d.nv,{id:"AltTextField",onChange:({value:e})=>t({value:e.slice(0,500)}),size:"lg",value:i||""})}),(0,c.jsx)(d.xu,{children:(0,c.jsx)(d.__,{htmlFor:"AltTextField",children:(0,c.jsx)(d.xu,{marginTop:1,children:(0,c.jsx)(d.xv,{size:"200",color:"subtle",children:s._('This helps people using screen readers understand what your Pin is about.', 'EditPinModal.EditAltText', 'Label for editing alt text of pin')})})})})]}):(0,c.jsx)(d.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",weight:"bold",children:i})})})]})]})}var z=i(879089),k=i(543398);function E({board:e={},canEdit:t,isOriginallyQuickCreatesBoard:i,onBoardChange:n,onBoardCreate:s,viewerId:o}){const r=(0,a.ZP)(),{showEnabledSaveBehavior:l}=(0,k.ZP)(o),u="quick_saves"===e.layout&&l,h="quick_creates"===e.layout;return(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"BoardPicker",children:(0,c.jsx)(d.xv,{size:"200",children:i?r._('Organize to a board (optional)', 'editPinModal.editBoard.optionalBoardLabel', 'Label for board dropdown to select optional board'):r._('Board', ' - ', ' -- ')})})}),t?(0,c.jsx)(d.xu,{column:12,mdColumn:8,"data-test-id":"edit-board",children:(0,c.jsx)(z.Z,{board:e,isBoardlessPinsBoard:u,isQuickCreatesBoard:h,onBoardChosen:n,onBoardCreate:s})}):e.name&&(0,c.jsx)(d.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",weight:"bold",children:e.name})})]})}var I=i(678691),T=i(194866),M=i(407043);function D(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class R extends n.Component{constructor(...e){super(...e),D(this,"state",{focused:!1}),D(this,"suggestionAnchorRef",(0,n.createRef)()),D(this,"handleBlur",(e=>{this.setState({focused:!1});const{onBlur:t}=this.props;t&&t(e)})),D(this,"handleFocus",(e=>{this.setState({focused:!0});const{onFocus:t}=this.props;t&&t(e)})),D(this,"handleChange",(({text:e,mentions:t})=>{this.props.onDescriptionChange({value:e,userMentionTags:t})}))}render(){const{canAddUserMentionTags:e,canEdit:t,description:i,errorMessage:s,initialMentions:o,label:r,placeholder:l,onDescriptionChange:a}=this.props,u={__style:{...this.state.focused?{boxShadow:"0 0 0 3px #92c2fb"}:{}}};return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"DescriptionField",children:(0,c.jsx)(d.xv,{size:"200",children:r})})}),t?(0,c.jsxs)(d.xu,{column:12,mdColumn:8,children:[(0,c.jsx)(d.xu,{children:e?(0,c.jsx)(d.xu,{borderStyle:"lg",dangerouslySetInlineStyle:u,id:"DescriptionField",minHeight:48,paddingX:2,paddingY:4,ref:this.suggestionAnchorRef,role:"textbox",rounding:4,children:(0,c.jsx)(I.Z,{initialMentions:o,initialText:i,onAddMention:()=>{this.props.logContextEvent({event_type:8905,element:116,aux_data:{tag_type:1}})},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onSearchMentionCancel:()=>{this.props.logContextEvent({event_type:8908,element:116,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:()=>{this.props.logContextEvent({event_type:8907,element:116,aux_data:{tag_type:1}})},maxSuggestions:4,placeholder:l})}):(0,c.jsx)(d.Kx,{id:"DescriptionField",placeholder:l,value:i,onChange:({value:e})=>{a({value:e,userMentionTags:[]})},hasError:(s||"").length>0})}),!!s&&(0,c.jsx)(d.xu,{children:(0,c.jsx)(T.Z,{errorMessage:s,htmlFor:"pin-edit-description"})})]}):(0,c.jsx)(d.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",weight:"bold",children:i})})]})]})}}const B=function(e){const{logContextEvent:t}=(0,M.v)();return(0,c.jsx)(R,{...e,logContextEvent:t})};var L=i(333070),N=i(842057),Z=i(822119);function F({isCarousel:e,onMouseEnter:t,onMouseLeave:i,shouldShowCarouselSliders:n,onCarouselSlide:s,currentIndex:o,carouselData:r,pinId:l,description:a,image:u={}}){return(0,c.jsxs)(d.xu,{paddingX:4,paddingY:3,children:[e&&(()=>{const e=r&&r.carousel_slots&&r.carousel_slots.length||1;return e>=2&&(0,c.jsx)(d.xu,{padding:2,children:(0,c.jsx)(d.__,{htmlFor:"CardsIndex",children:(0,c.jsxs)(d.xv,{size:"200",children:[o+1,"/",e]})})})})(),(0,c.jsx)(d.zd,{width:236,children:(0,c.jsxs)(d.xu,{onMouseEnter:t,onMouseLeave:i,children:[(0,c.jsxs)(d.zd,{rounding:2,wash:!0,children:[e&&n&&(0,c.jsx)(d.xu,{display:"inlineBlock",height:"100%",position:"absolute",width:"100%",zIndex:new d.Ry(10),dangerouslySetInlineStyle:{__style:{background:"rgba(0, 0, 0, 0.3)"}},children:(0,c.jsx)(N.default,{handleCarouselSwipe:s,carouselIndex:o,carouselData:r,pinId:l,isEditMode:!0})}),e?(0,c.jsx)(Z.Z,{carouselIndex:o,isCloseup:!1,carouselData:r,pinId:l,isEditMode:!0}):(0,c.jsx)(d.Ee,{alt:a,color:"#efefef",naturalHeight:u.height,src:u.url,naturalWidth:u.width})]}),e&&(0,c.jsx)(L.default,{carouselIndex:o,carouselData:r,pinId:l,handleCarouselSwipe:s,isEditMode:!0,variant:"legacy"})]})})]})}function O({apiErrorMessage:e,shouldShowGenericUpdateError:t,onClickDeleteButton:i,disableDelete:n,onHide:s,shouldDisableSave:o,triggerBoardAndSectionCreate:r}){const l=(0,a.ZP)();return(0,c.jsxs)(d.xu,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[(0,c.jsx)(b.Z,{id:"delete-pin-button",children:(0,c.jsx)(d.zx,{fullWidth:!0,text:l._('Delete', 'EditPinModal.EditPinFooter.Delete', 'delete pin'),onClick:i,disabled:n})}),t&&(0,c.jsx)(d.xu,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:(0,c.jsx)(T.Z,{errorMessage:e||l._('Sorry! There was an error editing your Pin.', 'EditPinModal.EditPinFooter.ErrorMessageToast', 'Toast for pin edit error'),htmlFor:"pin-edit-generic-error"})}),(0,c.jsxs)(d.xu,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[(0,c.jsx)(d.xu,{paddingX:2,children:(0,c.jsx)(d.zx,{fullWidth:!0,text:l._('Cancel', 'EditPinModal.EditPinFooter.Cancel', 'cancel changes'),onClick:s})}),(0,c.jsx)(d.xu,{paddingX:2,"data-test-id":"edit-pin-save",children:(0,c.jsx)(d.zx,{fullWidth:!0,text:l._('Save', 'EditPinModal.EditPinFooter.Save', 'save changes'),color:"red",onClick:r,disabled:o})})]})]})}function U({pinNoteText:e,isCollaborative:t,onPinNoteChange:i}){const s=(0,a.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"PinNoteField",children:(0,c.jsx)(d.xv,{size:"200",children:t?s._('Note to group', 'editPinModal.editPinNote.groupTitle', 'Label for editing private note on group Pin'):s._('Note to self', 'editPinModal.editPinNote.title', 'Label for editing private note on Pin')})})}),(0,c.jsx)(d.xu,{column:12,mdColumn:8,paddingY:2,"data-test-id":"note-to-self-input",children:(0,c.jsx)(d.Kx,{errorMessage:e.length>=500?s._('Character limit reached', 'editPinModal.editPinNote.warningText', 'Text to inform user they have reached the length limit on Pin note'):void 0,id:"PinNoteField",onChange:i,placeholder:s._('Add a private note to remember your ideas about this Pin', 'editPinModal.editPinNote.placeholderText', 'Placeholder for editing private note'),value:e})})]})]})}var Y=i(316298);function H({board:e,canEdit:t,currentSection:i,onSectionChange:n,onSectionCreate:s,sectionId:o,sectionName:r}){const l=(0,a.ZP)(),u=null!=e&&e.id?Y.Z:Y.x;return"quick_creates"===(null==e?void 0:e.layout)?null:(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:3,children:(0,c.jsx)(d.__,{htmlFor:"SectionPicker",children:(0,c.jsx)(d.xv,{size:"200",children:l._('Section', 'label for editing a Pin\'s board section', 'label for editing a Pin\'s board section')})})}),t&&e?(0,c.jsx)(d.xu,{column:12,mdColumn:8,children:(0,c.jsx)(u,{board:e,onSectionChange:n,selectedSectionId:o,selectedSectionName:r,onSectionCreate:s})}):(0,c.jsx)(d.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",weight:"bold",children:i&&!(e||{}).is_collaborative?i.title:l._('No section', 'default dropdown option for selecting a board section on pin edit', 'default dropdown option for selecting a board section on pin edit')})})]})}var V=i(969759);var G=i(952058);var W=i(791250),Q=i(803405),K=i(201238),X=i(70715);function q({keyValueBlocks:e,listBlocks:t,onUpdateKeyValueBlock:i,onUpdateListBlocks:s,templateType:o}){const r=(0,a.ZP)();return(0,c.jsxs)(d.xu,{children:[1===o&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:r._('Cook time', 'editModal.editStoryPinModal.details.cookTime', 'Label for cook time detail')}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(X.Z,{onUpdate:e=>i(0,e),value:e[0]||null})})]},"cooktime"),(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:r._('Servings', 'editModal.editStoryPinModal.details.servings', 'Label for serving size detail')}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(K.Z,{showLabel:!1,onUpdate:e=>i(1,e),value:e[1]||null})})]},"servingSize")]}),2===o&&(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:r._('Difficulty', 'editModal.editStoryPinModal.details.difficulty', 'Label for difficulty level detail')}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(W.Z,{showLabel:!1,onUpdate:e=>i(2,e),value:e[2]||null})})]},"difficulty"),(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:(()=>{switch(o){case 1:return r._('Ingredients', 'editModal.editStoryPinModal.listHeading', 'Heading for an ingredients list');case 2:return r._('Supplies', 'editModal.editStoryPinModal.listHeading', 'Heading for a supplies list');default:return r._('What they\'ll need', 'editModal.editStoryPinModal.listHeading', 'Heading for a generic list')}})()}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(Q.Z,{listBlocks:t,onUpdate:s})})]})]})}var $=i(349700),J=i(217468),ee=i(782534);const te=(0,s.connect)((()=>({})),(e=>({completeResourceFetch:t=>e((0,g.Sr)("PinResource",{field_set_key:"detailed",id:t.resource_response.data.id},t)),invalidatePin:t=>e((0,g.jB)("PinResource",{field_set_key:"detailed",id:t}))})))((function({apiErrorMessage:e,board:t,completeResourceFetch:i,commentsDisabled:s,description:o,disableDelete:r,invalidatePin:l,isLoadingPin:h,isProcessing:_,onChangeBoard:g,onChangeComment:m,onChangeSection:x,onClickBoardCreate:f,onClickDeleteButton:y,onClickEditPages:b,onClickSectionCreate:P,onHide:j,pinResource:C,sectionId:S,sectionName:w,title:A,triggerBoardAndSectionCreate:k}){var E,I,M,D,R,B,L,N;const Z=(0,a.ZP)(),F=null!==(E=C.data)&&void 0!==E?E:{},O=F.story_pin_data,U=null!==(I=F.images&&F.images["474x"])&&void 0!==I?I:{},[H,W]=(0,n.useState)(!1),[Q,K]=(0,n.useState)(null),[X,te]=(0,n.useState)(!1),[ie,ne]=(0,n.useState)({}),[se,oe]=(0,n.useState)([]);(0,n.useEffect)((()=>{var e;const t=(null==O||null===(e=O.metadata)||void 0===e?void 0:e.basics)||null;if(t){const e=(0,G._i)(t);ne(e.keyValueBlocks||{}),oe(e.listBlocks||[])}}),[O]),(0,n.useEffect)((()=>{e&&K(e)}),[e]);const{anyEnabled:re}=(0,J.aq)("web_story_pin_edit_deprecation"),le=F.created_at?new Date(F.created_at):null,ae=le&&(0,V.Z)(le,14),de=!re&&!!ae&&new Date<ae,ce=se.length>0||Object.keys(ie).length>0,ue=(0,$.nk)(Z._('Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Idea Pin is published. Edit the board and engagement settings any time.', 'editModal.editStoryPinModal.editTimeInformation', 'Let the user know how the edit settings are limited'),{numDays:14});return(0,c.jsx)(v.ZP,{accessibilityModalLabel:Z._('Edit your previously saved pin', 'editModal.editStoryPinModal.accessibilityLabel', 'Accessible label for edit previously saved story pin modal'),footer:(0,c.jsxs)(d.kC,{alignItems:"stretch",justifyContent:"between",children:[(0,c.jsx)(d.xu,{"data-test-id":"delete-pin-button",children:(0,c.jsx)(d.zx,{fullWidth:!0,color:"white",disabled:r,onClick:y,size:"lg",text:Z._('Delete', 'editModal.editStoryPinModal.deleteButton', 'Delete button for previously saved story pin')})}),!!Q&&(0,c.jsx)(d.kC,{alignItems:"stretch",justifyContent:"center",children:(0,c.jsx)(T.Z,{errorMessage:Q,htmlFor:"pin-edit-generic-error"})}),(0,c.jsxs)(d.xu,{display:"flex",justifyContent:"between",marginEnd:-1,marginStart:-1,children:[(0,c.jsx)(d.xu,{paddingX:1,children:(0,c.jsx)(d.zx,{fullWidth:!0,onClick:j,size:"lg",text:Z._('Cancel', 'editModal.editStoryPinModal.cancelButton', 'Cancel button to not save edits to previously saved story pin')})}),(0,c.jsx)(d.xu,{"data-test-id":"edit-pin-save",paddingX:1,children:(0,c.jsx)(d.zx,{fullWidth:!0,color:"red",onClick:()=>{if(H&&O){te(!0);const e=(0,G.Fe)({keyValueBlocks:ie,listBlocks:se}),t=function(e){var t,i,n,s,o,r,l;return{metadata:{basics:null!==(t=e.metadata)&&void 0!==t&&t.basics?(0,G.CH)(e.metadata.basics):void 0,diy_data:null===(i=e.metadata)||void 0===i?void 0:i.diy_data,pin_image_signature:null===(n=e.metadata)||void 0===n?void 0:n.pin_image_signature,pin_title:null===(s=e.metadata)||void 0===s?void 0:s.pin_title,recipe_data:null===(o=e.metadata)||void 0===o?void 0:o.recipe_data,template_type:null===(r=e.metadata)||void 0===r?void 0:r.template_type},pages:(l=e.pages,(null!=l?l:[]).map((e=>{var t,i;const n=(null!==(t=e.blocks)&&void 0!==t?t:[]).map((e=>{switch(e.type){case"story_pin_paragraph_block":return{block_style:e.block_style,style:e.style,text:e.text,type:0};case"story_pin_heading_block":return{block_style:e.block_style,level:e.level,style:e.style,text:e.text,type:1};case"story_pin_image_block":return{block_style:e.block_style,image_signature:e.image_signature,tracking_id:e.tracking_id,type:2};case"story_pin_video_block":return{block_style:e.block_style,tracking_id:e.tracking_id,type:3,video_signature:e.video_signature};default:return null}})).filter(Boolean);return n.length>0?{blocks:n,layout:e.layout,style:null!==(i=e.style)&&void 0!==i&&i.background_color?{background_color:e.style.background_color}:void 0}:null})).filter(Boolean))}}(O),n={...t,metadata:{...t.metadata,basics:e}},s={pin_id:F.id,story_pin:JSON.stringify(n)};p.ZP.create("StoryPinEditResource",s).callUpdate().then((e=>{l(F.id),i(e),k()})).catch((e=>{K(e.message),te(!1)}))}else k()},size:"lg",text:Z._('Done', 'editModal.editStoryPinModal.doneButton', 'Done button to save edits to previously saved story pin')})})]})]}),heading:Z._('Edit Pin', 'editModal.editStoryPinModal.heading', 'Edit a previously saved story pin'),onDismiss:j,size:"md",children:h||!C.isLoaded||X||_?(0,c.jsx)(d.xu,{paddingX:12,paddingY:9,children:(0,c.jsx)(d.$j,{accessibilityLabel:Z._('Loading edit information', 'editPinModal.editStoryPinModal.spinner', 'Accessible label for the edit pin loading icon'),show:!0})}):(0,c.jsx)(d.xu,{overflow:"hidden",children:(0,c.jsx)(d.xu,{marginEnd:-4,marginStart:-4,children:(0,c.jsxs)(d.xu,{display:"flex",minHeight:300,overflow:"hidden",paddingX:8,children:[(0,c.jsxs)(d.xu,{alignItems:"center",direction:"column",display:"flex",flex:"shrink",paddingX:4,children:[(0,c.jsxs)(d.zd,{wash:!0,rounding:4,width:120,children:[(0,c.jsx)(d.Ee,{alt:o,color:"#efefef",naturalHeight:null!==(M=U.height)&&void 0!==M?M:1,naturalWidth:null!==(D=U.width)&&void 0!==D?D:1,src:null!==(R=U.url)&&void 0!==R?R:""}),(0,c.jsx)(d.xu,{position:"absolute",left:!0,top:!0,padding:2,children:(0,c.jsxs)(d.xu,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"center",opacity:.8,padding:2,rounding:"pill",children:[(0,c.jsx)(d.JO,{accessibilityLabel:Z._('Idea Pin icon', 'editModal.editStoryPinModal.storyPinIndicator', 'Idea Pin icon indicator'),color:"default",icon:"idea-pin",size:12}),(0,c.jsx)(d.xu,{marginStart:1,children:(0,c.jsx)(d.xv,{size:"200",weight:"bold",children:null===(B=F.story_pin_data)||void 0===B?void 0:B.page_count})})]})})]}),de?(0,c.jsx)(d.xu,{"data-test-id":"edit-pages-button",paddingY:2,children:(0,c.jsx)(d.zx,{onClick:b,text:Z._('Edit pages', 'editModal.editStoryPinModal.editPagesButton', 'Edit pages label for story pin creation entry point')})}):null]}),(0,c.jsx)(d.xu,{direction:"column",display:"flex",flex:"grow",paddingX:4,children:(0,c.jsx)(d.xu,{marginBottom:-2,marginTop:-2,children:(0,c.jsx)(d.xu,{maxHeight:500,overflow:"auto",paddingX:1,children:(0,c.jsxs)(d.xu,{maxWidth:504,children:[ae&&(0,c.jsx)(d.xu,{paddingY:2,children:de?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.xv,{size:"200",children:(0,$.nk)(Z._('Edit until {{ editDate }}', 'editModal.editStoryPinModal.lastEditableDate', 'Let user know the last date this Pin can be edited on'),{editDate:(0,c.jsx)(ee.Z,{dateFormatType:ee.k.NUMERIC,useUTC:!1,value:ae},`noEditsTwoWeeksAfter-${null!==(L=F.created_at)&&void 0!==L?L:""}`)})}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(d.xv,{color:"subtle",size:"200",children:ue})})]}):(0,c.jsxs)(d.xu,{children:[(0,c.jsx)(d.xv,{size:"200",children:Z._('Editing', 'editModal.editStoryPinModal.editLabel', 'Label header for informing users story pin is only editable for board selection')}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",color:"subtle",children:Z._('Only board selection and engagement settings can be changed!', 'editModal.editStoryPinModal.editLabel', 'Label header for informing users story pin is only editable for board selection')})})]})}),(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:Z._('Title', 'editModal.editStoryPinModal.titleLabel', 'Label for form input where users will input the title of their pin')}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsxs)(d.xu,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"between",padding:4,rounding:4,children:[(0,c.jsx)(d.xv,{color:"subtle",lineClamp:1,children:A||""}),(0,c.jsx)(d.JO,{accessibilityLabel:Z._('Lock', 'editModal.editStoryPinModal.lockIcon.accessibilityLabel', 'Label for the lock icon to show that editing a story pin title is locked'),color:"default",icon:"lock"})]})})]}),(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:Z._('Board', 'editModal.editStoryPinModal.boardLabel', 'Label for dropdown where users will choose their board')}),(0,c.jsx)(d.xu,{paddingY:2,children:t?(0,c.jsx)(z.Z,{board:t,isStoryPin:!0,onBoardChosen:g,onBoardCreate:f}):null})]}),(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:Z._('Section', 'editModal.editStoryPinModal.sectionLabel', 'Label for dropdown where users will choose their section')}),(0,c.jsx)(d.xu,{paddingY:2,children:(null==t?void 0:t.id)&&(0,c.jsx)(Y.Z,{isStoryPin:!0,board:t,onSectionChange:x,onSectionCreate:P,selectedSectionId:S,selectedSectionName:w})})]}),ce&&de&&(0,c.jsx)(q,{keyValueBlocks:ie,listBlocks:se,onUpdateKeyValueBlock:(e,t)=>{ne({...ie,[e]:t}),W(!0)},onUpdateListBlocks:e=>{oe(e),W(!0)},templateType:null==O||null===(N=O.metadata)||void 0===N?void 0:N.template_type}),F.can_delete_did_it_and_comments&&(0,c.jsxs)(d.xu,{paddingY:2,children:[(0,c.jsx)(d.xv,{size:"200",children:Z._('Comments and photos permissions', 'editModal.editStoryPinModal.commentsAndPhotosPermissionsLabel', 'Label for dropdown where users can toggle off permissions for comments and photos')}),(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(u,{isNoTitle:!0,commentsDisabled:s,onCommentChange:m})})]})]})})})})]})})})})}));function ie({canEdit:e,onTitleChange:t,title:i,errorMessage:s}){const o=(0,a.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"TitleField",children:(0,c.jsx)(d.xv,{size:"200",children:o._('Title', 'Label for editing title of pin', 'Label for editing title of pin')})})}),(0,c.jsx)(d.xu,{column:12,mdColumn:8,children:e?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.xu,{"data-test-id":"pin-title-input",children:(0,c.jsx)(d.nv,{hasError:(s||"").length>0,id:"TitleField",onChange:t,size:"lg",value:i})}),!!s&&(0,c.jsx)(d.xu,{children:(0,c.jsx)(T.Z,{errorMessage:s,htmlFor:"pin-edit-title"})})]}):(0,c.jsx)(d.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",weight:"bold",children:i})})})]})]})}function ne({onChangeWebsite:e,link:t,errorMessage:i}){const s=(0,a.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"WebsiteField",children:(0,c.jsx)(d.xv,{size:"200",children:s._('Website', ' - ', ' -- ')})})}),(0,c.jsxs)(d.xu,{column:12,mdColumn:8,children:[(0,c.jsx)(d.xu,{children:(0,c.jsx)(d.nv,{hasError:(i||"").length>0,id:"WebsiteField",onChange:e,size:"lg",value:t})}),!!i&&(0,c.jsx)(d.xu,{children:(0,c.jsx)(T.Z,{errorMessage:i,htmlFor:"pin-edit-website"})})]})]})]})}var se,oe=i(417498),re=i(674578),le=i(947599),ae=i(167912);const de=void 0!==se?se:se=i(337148);function ce({onShoppingRecChange:e,shoppingRecDisabled:t,storyPinData:i}){var s,o;const r=(0,a.ZP)(),l=(0,ae.useLazyLoadQuery)(de,{});if(!l)return null;const{has_product_pins:u}=i||{},h=null===(s=l.v3GetCurrentUserHandlerQuery)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.ipStelaRecDisabled;return(0,c.jsx)(n.Fragment,{children:(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,children:[(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",children:r._('Shopping recommendations', 'Heading for shopping recommendations permissions', 'shopping.recommendations')})}),(0,c.jsx)(d.xu,{column:12,mdColumn:8,children:(0,c.jsxs)(d.xu,{paddingY:1,display:"flex",alignItems:"start",children:[(0,c.jsx)(d.rs,{onChange:e,id:"PhotoSwitch",switched:!t,disabled:h||u}),(0,c.jsx)(d.xu,{paddingX:2,children:(0,c.jsx)(d.__,{htmlFor:"stelaSwitch",children:(0,c.jsxs)(d.kC,{alignItems:"stretch",justifyContent:"start",direction:"column",children:[(0,c.jsx)(d.xv,{size:"200",color:h?"subtle":"default",children:r._('Show similar products ', 'Label to toggle similar products on ideal pin', 'ideaPin.stela.toggle')}),h?(0,c.jsxs)(d.xv,{color:"subtle",size:"200",children:[r._('You\u2019ve disabled shopping recommendations for your profile ', 'Text indicating shopping recommendations are currently disabled', 'ideaPin.disable'),(0,c.jsx)(d.xv,{inline:!0,size:"200",weight:"bold",color:"subtle",children:(0,c.jsx)(d.rU,{inline:!0,href:"/settings/permissions",underline:"hover",children:r._('Edit profile settings', 'Link to the settings page to enable shopping recommendations on idea pins', 'ideaPin.link')})})]}):(0,c.jsxs)(d.xu,{display:"flex",direction:"column",marginTop:1,children:[(0,c.jsx)(d.xu,{marginBottom:1,children:(0,c.jsx)(d.xv,{size:"200",children:r._('People can shop products similar to what\u2019s shown in this Idea Pin using visual search', 'Text indicating shopping recommendations are currently enabled', 'ideaPin.enable')})}),(0,c.jsx)(d.xv,{size:"200",children:r._('Shopping recommendations aren\u2019t available for Idea Pins with product or paid partnership tags', 'Explanation about how stela on idea pins with tagged products arent available', 'ideaPin.tagged.unavailable')})]})]})})})]})})]})})}function ue({shoppingRecDisabled:e,onShoppingRecChange:t,isNoTitle:i}){const s=(0,a.ZP)();return(0,c.jsxs)(n.Fragment,{children:[!i&&(0,c.jsx)(d.iz,{}),(0,c.jsxs)(d.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:i?0:3,children:[!i&&(0,c.jsx)(d.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(d.xv,{size:"200",children:s._('Recommendations', 'EditPinModal.recommendations', 'Title of a section in the edit pin modal to manage recommendations on a specific pin.')})}),(0,c.jsx)(d.xu,{column:12,mdColumn:8,children:(0,c.jsxs)(d.xu,{paddingY:1,display:"flex",alignItems:"center",children:[(0,c.jsx)(d.rs,{onChange:t,id:"ShoppingRecSwitch",switched:!e}),(0,c.jsx)(d.xu,{paddingX:2,children:(0,c.jsx)(d.__,{htmlFor:"ShoppingRecSwitch",children:(0,c.jsx)(d.xv,{size:"200",children:s._('Show shopping recommendations', 'EditPinModal.recommendations.showShoppingRecommendations.label', 'Label for toggling showing shopping recommendations on a specific pin.')})})})]})})]})]})}var he=i(717615),_e=i(357409),pe=i(784590),ge=i(19121),me=i(203997),xe=i(700314),fe=i(224496),ve=i(281615),ye=i(293880),be=i(865615),Pe=i(482546),je=i(232843),Ce=i(957885),Se=i(231947),we=i(780280),Ae=i(708206),ze=i(619983),ke=i(134906),Ee=i(843747),Ie=i(925927);function Te(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Me(e){return Boolean(e&&e.trim().length)}function De(e,t){const i=Me(e),n=Me(t);return(i||n)&&e!==t}class Re extends n.Component{constructor(...e){var t,i,n,s,o,r,a,d,c,u,_,g,m,x,v,y,b,P,j;super(...e),Te(this,"state",{altText:(null===(t=this.props.pinResource.data)||void 0===t?void 0:t.alt_text)||"",board:(null===(i=this.props.pinResource.data)||void 0===i?void 0:i.board)||null,commentsDisabled:(null===(n=this.props.pinResource.data)||void 0===n?void 0:n.comments_disabled)||(null===(s=this.props.pinResource.data)||void 0===s?void 0:s.did_it_disabled)||!1,description:(null===(o=this.props.pinResource.data)||void 0===o||null===(r=o.description)||void 0===r?void 0:r.trim())||"",apiErrorMessage:null,link:(null===(a=this.props.pinResource.data)||void 0===a?void 0:a.link)||"",pinNoteText:(null===(d=this.props.pinResource.data)||void 0===d||null===(c=d.pin_note)||void 0===c?void 0:c.text)||"",sectionId:(null===(u=this.props.pinResource.data)||void 0===u||null===(_=u.section)||void 0===_?void 0:_.id)||null,sectionName:(null===(g=this.props.pinResource.data)||void 0===g||null===(m=g.section)||void 0===m?void 0:m.title)||null,showDeleteConfirmation:!1,carousel_data:(null===(x=this.props.pinResource.data)||void 0===x?void 0:x.carousel_data)||null,title:(null===(v=this.props.pinResource.data)||void 0===v?void 0:v.title)||"",isLoadingPin:!Boolean(this.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==this.props.carouselSlotCurrentIndex?this.props.carouselSlotCurrentIndex:(null===(y=this.props.pinResource.data)||void 0===y||null===(b=y.carousel_data)||void 0===b?void 0:b.index)||0,shoppingRecDisabled:null===(P=this.props.pinResource.data)||void 0===P?void 0:P.shopping_rec_disabled,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(j=this.props.pinResource.data)||void 0===j?void 0:j.user_mention_tags)||[]}),Te(this,"onClickDeleteButton",(()=>this.setState({showDeleteConfirmation:!0}))),Te(this,"onHideConfirmation",(()=>this.setState({showDeleteConfirmation:!1}))),Te(this,"updateCarouselSlotIndex",(()=>{const{carouselSlotCurrentIndex:e}=this.props;this.setState({currentIndex:void 0!==e?e:this.props.pinResource.data&&this.props.pinResource.data.carousel_data&&this.props.pinResource.data.carousel_data.index||0})})),Te(this,"handleBoardChange",(e=>{const{board:{id:t}}=this.state;e.id!==t&&this.setState({board:e,sectionId:null,sectionName:null})})),Te(this,"createBoard",(e=>{const{createBoard:t,viewer:i,orbacActingAs:n}=this.props,{board:s}=this.state,o=(0,Se.lJ)(i,n);!s.id&&s.name&&e&&t(s.name,e,o).then((e=>{if(this._isMounted){const{sectionId:t,sectionName:i}=this.state;!t&&i?(this.setState({board:e}),this.createSection()):(this.handleBoardChange(e),this.handleSave())}}))})),Te(this,"handleBoardCreateClick",(e=>{if(!e)return;const t={name:e,privacy:h.Z.BoardPrivacy.PUBLIC,access:"write"};this.setState({board:t,sectionId:null,sectionName:null})})),Te(this,"createSection",(()=>{const{board:e,sectionName:t}=this.state,{viewer:i,orbacActingAs:n}=this.props,s=(0,Se.lJ)(i,n);if(!t)return;if(!e.id)return void this.createBoard();const o={boardId:e.id,name:t},{createSection:r}=this.props;r(o,s).then((e=>{this._isMounted&&(this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),this.handleSave())})).catch((()=>{this.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})}))})),Te(this,"handleSectionCreateClick",(e=>{if(0===e.length)return;const{board:t}=this.state;t&&this.setState({sectionId:null,sectionName:e})})),Te(this,"handleSectionChange",(e=>this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1}))),Te(this,"handleDeletePin",(()=>{const{advertiser_id:e,changeBoardPinCount:t,changeUserPinCount:i,dispatch:n,onDelete:s,onHide:o,orbacActingAs:r,pinId:l,pinResource:{data:a},removeBoardlessPin:d,viewer:c}=this.props,u=(0,Se.lJ)(c,r),h={...e?{advertiser_id:e}:{},...u?{orbac_subject_id:u}:Object.freeze({}),id:l};return p.ZP.create("PinResource",h).callDelete().then((()=>{if(this._isMounted){if(!a)return;const{board:{id:e}={},pinner:{id:r}={},section:d}=a,c=null==d?void 0:d.id;t({boardId:e,sectionId:c,increment:-1}),i({userId:r,increment:-1}),n((0,ye.xQ)(e)),n((0,re.Z)({feedId:c||e,feedType:c?ve.DV.SECTION_PINS:ve.DV.BOARD_PINS,itemIds:[l],itemType:"pin"})),n((0,re.Z)({feedId:r,feedType:ve.DV.CREATED_TAB_STORY_PINS_FEED,itemIds:[l],itemType:"pin"})),n((0,re.Z)({feedId:r,feedType:ve.DV.CREATED_TAB_ACTIVITY_PINS_FEED,itemIds:[l],itemType:"pin"})),c&&n((0,oe.Z)(c)),o(),s&&s()}c.id&&d(c.id,l)}))})),Te(this,"sanitizeCarouselData",(e=>{let{carousel_data:t}=this.state;if(e&&(t=e),t){const{carousel_slots:e}=t;if(e){const t={carousel_slots:[]};return e.forEach((e=>{const i={};i.description=e.details||"",i.title=e.title||"",i.link=e.link||"",t.carousel_slots.push(i)})),t}}return null})),Te(this,"triggerBoardAndSectionCreate",(e=>()=>{const{board:t,sectionId:i,sectionName:n}=this.state;t&&!t.id&&t.name?this.createBoard(e):!i&&n?this.createSection():this.handleSave()})),Te(this,"logPinEditEvent",((e,t,i,n,s)=>{const o={},{pinId:r,view:l,viewParameter:a}=this.props,{userMentionTags:d}=this.state;if(o.objectId=r,o.num_user_mention_tags=d.length,e&&(o.board_was_modified=!0),!e&&t&&(o.board_section_was_modified=!0),i){const{description:e}=this.state,{description:t}=s;o.original_pin_description=t,o.edited_pin_description=e}if(n){const{carousel_data:e}=this.state,{carousel_data:t}=s;o.original_carousel_data=JSON.stringify(this.sanitizeCarouselData(t)),o.edited_carousel_data=JSON.stringify(this.sanitizeCarouselData(e))}this.props.logContextEvent({event_type:2,component:208,view_type:l,view_parameter:a,aux_data:{...o}})})),Te(this,"handleSave",(()=>{this.setState({apiErrorMessage:null,isProcessing:!0});const{advertiser_id:e,completeResourceFetch:t,invalidatePinResource:i,orbacActingAs:n,pinId:s,pinResource:{data:o},onHide:r,removeBoardlessPin:l,updatePinNote:a,viewer:d}=this.props;if(!o)return;const{alt_text:c,board:u,comments_disabled:h,did_it_disabled:_,title:g,description:m,link:x,pin_note:v,section:y,carousel_data:b,shopping_rec_disabled:P}=o,j=null==v?void 0:v.text,{carousel_data:C,shouldShowValidationLinkFormatError:S}=this.state;let w;if(C){const e=this.sanitizeCarouselData();e&&(w=JSON.stringify(e))}const{altText:A,board:z,commentsDisabled:k,currentIndex:E,title:I,description:T,pinNoteText:M,sectionId:D,shoppingRecDisabled:R,carousel_data:B,userMentionTags:L}=this.state,N=z||u,Z=S?x:this.state.link,F=(0,Se.lJ)(d,n),O={alt_text:A,board_id:null==N?void 0:N.id,board_section_id:D,carousel_data_json:w,description:T,disable_comments:k,disable_did_it:k,id:s,link:Z,shopping_rec_disabled:R,title:I,user_mention_tags:JSON.stringify(L),...e?{advertiser_id:e}:{},...F?{orbac_subject_id:F}:Object.freeze({})},U=y&&y.id||null,Y=null==N?void 0:N.id,H=null==u?void 0:u.id,V=De(c,A),G=H!==Y,W=(Boolean(U)||Boolean(D))&&U!==D,Q=De(g,I),K=De(m,T),X=De(x,Z),q=Boolean(B)&&Boolean(b)&&!f()(B,b),$=h!==k||_!==k,J=De(j,M);V||G||W||Q||K||J||X||q||$||P!==R?(J&&a(s,j,M,F),p.ZP.create("PinResource",O).callUpdate().then((e=>{if(this._isMounted){var n;const{changeBoardPinCount:c,onSubmit:u,pinId:h,pinMoved:_}=this.props;var s,a;if((G||W)&&Y&&H)_({selectedPinIds:[h],source:{boardId:H,sectionId:U},target:{boardId:Y,sectionId:D}}),c({boardId:Y,sectionId:D||void 0,increment:1}),c({boardId:H,sectionId:U||void 0,increment:-1}),d.id&&"quick_saves"===(null===(s=o.board)||void 0===s?void 0:s.layout)&&l(d.id,h);if(u&&Y&&null!=N&&N.url)u({boardId:Y,title:null!==(a=N.name)&&void 0!==a?a:"",sectionId:D,url:N.url});r(),i(h,F),null!==(n=e.resource_response)&&void 0!==n&&n.data.carousel_data&&(e.resource_response.data.carousel_data.index=E),t(e,F),this.logPinEditEvent(G,W,K,q,o)}})).catch((()=>{const{shouldShowValidationTitleError:e,shouldShowValidationDescriptionError:t,shouldShowValidationLinkFormatError:i}=this.state;this.setState({isProcessing:!1,shouldShowGenericUpdateError:!e&&!t&&!i})}))):(r(),i(s,F)),this.setState({isProcessing:!1})})),Te(this,"handleTextChanges",((e,t)=>{const{carousel_data:i}=this.state;if(!i)return;const n=l()(i),{carousel_slots:s=[]}=n,{currentIndex:o,shouldApplyTextToAll:r,description:a,link:d,title:c}=this.state,u=this.valueIsValidForType(e,t);switch(r?s.forEach((i=>i[t]=e)):s[o]&&(s[o][t]=e),t){case"details":const t=0===o?e:a;this.setState({description:t,carousel_data:n||null,shouldShowValidationDescriptionError:!u,shouldShowGenericUpdateError:!1});break;case"link":const i=0===o?e:d;this.setState({link:i,carousel_data:n||null,shouldShowValidationLinkFormatError:!u,shouldShowGenericUpdateError:!1});break;case"title":const s=0===o?e:c;this.setState({title:s,carousel_data:n||null,shouldShowValidationTitleError:!u,shouldShowGenericUpdateError:!1})}})),Te(this,"handleDescriptionChange",(({value:e,userMentionTags:t})=>{const i=this.valueIsValidForType(e,"description"),n=this.valueIsValidForType(t,"userMentionTags");t.length<this.state.userMentionTags.length&&this.props.logContextEvent({event_type:8906,element:116,aux_data:{tag_type:1}}),this.setState({description:e,userMentionTags:t,shouldShowValidationDescriptionError:!i,shouldShowValidationUserMentionTagsError:!n,shouldShowGenericUpdateError:!1})})),Te(this,"handleCarouselDetailsChange",(({value:e})=>{this.handleTextChanges(e,"details")})),Te(this,"handleTitleChange",(({value:e})=>{const t=this.valueIsValidForType(e,"title");this.setState({title:e,shouldShowValidationTitleError:!t,shouldShowGenericUpdateError:!1})})),Te(this,"handleCarouselTitleChange",(({value:e})=>{this.handleTextChanges(e,"title")})),Te(this,"handleAltTextChange",(({value:e})=>{this.setState({altText:e})})),Te(this,"valueIsValidForType",((e,t)=>{switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===(0,ke.FU)([(0,ke.Jx)({message:this.props.i18n._('Not a valid url.', 'Validation error for an improperly formated url', 'Validation error for an improperly formated url')})],e).length;case"title":return e.length<=100;case"userMentionTags":return e.length<=5;default:return!0}})),Te(this,"handleWebsiteChange",(({value:e})=>{const t=this.valueIsValidForType(e,"link");this.setState({link:e,shouldDisableSave:!t,shouldShowValidationLinkFormatError:!t,shouldShowGenericUpdateError:!1})})),Te(this,"handleCarouselWebsiteChange",(({value:e})=>{this.handleTextChanges(e,"link")})),Te(this,"handleCommentChange",(e=>this.setState({commentsDisabled:!e.value}))),Te(this,"handleShoppingRecChange",(e=>{this.setState({shoppingRecDisabled:!e.value})})),Te(this,"handleShouldApplyToAll",(e=>{if(e){const{currentIndex:t=0,carousel_data:i}=this.state;if(!i)return;const n=l()(i),{carousel_slots:s=[]}=n,{details:o,link:r,title:a}=s[t];s.forEach((e=>{e.details=o,e.title=a,e.link=r})),this.setState({carousel_data:n,shouldApplyTextToAll:e})}else this.setState({shouldApplyTextToAll:e})})),Te(this,"handleCarouselSlider",(e=>{const{carousel_data:t}=this.state,i=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<i&&this.setState({currentIndex:e})})),Te(this,"handleClickStoryPinPages",(()=>{const{pinResource:{data:e},history:t}=this.props;e&&t.push(`/idea-pin-builder/${e.id}/edit`)})),Te(this,"handleMouseEnter",(()=>{this.setState({shouldShowCarouselSliders:!0})})),Te(this,"handleMouseLeave",(()=>{this.setState({shouldShowCarouselSliders:!1})}))}componentDidMount(){this._isMounted=!0,this.updateCarouselSlotIndex()}componentDidUpdate(e){const{pinResource:{data:t,isLoaded:i},carouselSlotCurrentIndex:n}=this.props;var s;t&&i!==e.pinResource.isLoaded&&this.setState({altText:t.alt_text,board:t.board,commentsDisabled:t.comments_disabled||t.did_it_disabled,description:t.description&&t.description.trim(),isLoadingPin:!1,link:t.link,pinNoteText:(null===(s=t.pin_note)||void 0===s?void 0:s.text)||"",sectionId:(t.section||{}).id,sectionName:(t.section||{}).title,title:t.title,carousel_data:t.carousel_data,currentIndex:void 0!==n?n:t.carousel_data&&t.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:t.user_mention_tags||[],shoppingRecDisabled:t.shopping_rec_disabled})}componentWillUnmount(){this._isMounted=!1}getCurrentUserId(e){return e.isAuth?e.id:""}render(){var e,t,i;const{disableDelete:n,onHide:s,orbacActingAs:r,pinResource:l,pinId:a,requestContext:h,viewer:_}=this.props,{experiments:p}=h,{altText:g,apiErrorMessage:m,board:x,commentsDisabled:f,description:y,link:b,pinNoteText:P,sectionId:j,sectionName:C,showDeleteConfirmation:S,title:z,isLoadingPin:k,isProcessing:I,carousel_data:T,shouldApplyTextToAll:M,currentIndex:D,shoppingRecDisabled:R,shouldDisableSave:L,shouldShowCarouselSliders:N,shouldShowValidationTitleError:Z,shouldShowValidationDescriptionError:Y,shouldShowValidationLinkFormatError:V,shouldShowGenericUpdateError:G,shouldShowValidationUserMentionTagsError:W,userMentionTags:Q}=this.state,K=l.data||{},X=!!(K&&K.story_pin_data_id&&K.story_pin_data),q=(null===(e=K.native_creator)||void 0===e?void 0:e.id)===this.getCurrentUserId(_);if(S)return(0,c.jsx)(w,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation,showStoryPinCreatorDeleteMessage:X&&q});const $=!!(T&&T.carousel_slots&&T.carousel_slots.length>1),J=T&&T.carousel_slots&&T.carousel_slots.length>0&&T.carousel_slots[D]||{},{details:ee="",link:se="",title:oe=""}=J,re=K&&(K.access||[]).includes("write")||this.props.canEdit||!!x&&(0,o.Z)({action:4,board:x,viewer:_})||!!x&&(0,Se.KY)(_,x,r),ae=e=>{const t=(0,Se.lJ)(e,r),i=t||this.getCurrentUserId(e),n=this.props.canEdit&&this.props.advertiserOwnerUserId?this.props.advertiserOwnerUserId:i;return re&&!K.is_repin&&!X&&($||!T)&&(K.native_creator&&K.native_creator.id===n||$&&K.pinner&&K.pinner.id===n||K.link_domain&&K.link_domain.official_user&&K.link_domain.official_user.id===n||!!K.domain&&K.pinner&&K.pinner.id===n&&K.pinner.domain_url&&K.pinner.domain_url.includes(K.domain))},de=K&&K.images&&K.images["474x"]||{},he=new ze.v(h,"web_story_pin_creator").enabledWithNoActivation(),_e=new ze.v(h,"web_alt_text").enabledWithNoActivation(),pe=!new ze.e(h,"web_ip_stela_opt_in").getGroup().includes("pwt")&&new ze.v(h,"web_ip_stela_opt_in").enabled(),ge=X&&!!K.story_pin_data&&pe&&q,me=K.story_pin_data&&K.story_pin_data.metadata&&K.story_pin_data.metadata.version?(0,xe.n)(K.story_pin_data.metadata.version,fe.RR):null,ve=null!=me&&me>=0,ye=!!K.story_pin_data&&!!K.story_pin_data.metadata&&!!K.story_pin_data.metadata.is_editable&&K.native_creator&&K.native_creator.id===this.getCurrentUserId(_);if(X&&he&&ve&&ye)return(0,c.jsx)(te,{apiErrorMessage:m,board:x,commentsDisabled:f,description:y,disableDelete:!re||n,isLoadingPin:k,isProcessing:I,onChangeBoard:this.handleBoardChange,onChangeComment:this.handleCommentChange,onChangeSection:this.handleSectionChange,onClickBoardCreate:this.handleBoardCreateClick,onClickDeleteButton:this.onClickDeleteButton,onClickEditPages:this.handleClickStoryPinPages,onClickSectionCreate:this.handleSectionCreateClick,onHide:s,pinResource:l,sectionId:j,sectionName:C,title:z,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(_.username&&_.username)});const be=ae(_)?(0,c.jsx)(ie,{canEdit:re,onTitleChange:$?this.handleCarouselTitleChange:this.handleTitleChange,title:$&&oe?oe:z,errorMessage:Z?(0,Ce.Y8)($,this.props.i18n):""}):null,Pe=(re||_.isAuth&&(K.pinner||{}).id===_.id)&&ae(_)?(0,c.jsx)(B,{canAddUserMentionTags:!$,canEdit:re,description:($?ee:y)||"",errorMessage:(()=>Y?(0,Ce.MM)($,this.props.i18n):W?(0,Ce.bl)($,this.props.i18n):"")(),initialMentions:Q,label:this.props.i18n._('Description', 'Label for editing description', 'Label for editing description'),placeholder:this.props.i18n._('Tell us about this Pin...', 'Placeholder for editing description', 'Placeholder for editing description'),onDescriptionChange:$?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,je=(0,c.jsx)(U,{isCollaborative:!(null==x||!x.is_collaborative),onPinNoteChange:({value:e})=>{this.setState({pinNoteText:e})},pinNoteText:P}),we=(e=>ae(e)&&!(K.aggregated_pin_data&&K.aggregated_pin_data.is_shop_the_look))(_)?(0,c.jsx)(ne,{link:$&&se?se:b,onChangeWebsite:$?this.handleCarouselWebsiteChange:this.handleWebsiteChange,errorMessage:V?(0,Ce.qj)($,this.props.i18n):""}):null,Ae=$?(0,c.jsxs)(d.xu,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[(0,c.jsx)(d.xu,{paddingY:2,children:(0,c.jsx)(d.__,{htmlFor:"applyTextToAll",children:(0,c.jsx)(d.xv,{children:this.props.i18n._('Apply text to all', 'Apply title, description, link to all cards', 'Apply title, description, link to all cards')})})}),(0,c.jsx)(d.xu,{paddingX:2,paddingY:2,children:(0,c.jsx)(d.rs,{onChange:e=>this.handleShouldApplyToAll(e.value),id:"applyTextToAll",switched:M})})]}):null,ke=ae(_)&&_e?(0,c.jsx)(A,{canEdit:re,onAltTextChange:this.handleAltTextChange,altText:g}):null,Ee=K.can_delete_did_it_and_comments?(0,c.jsx)(u,{commentsDisabled:f,onCommentChange:this.handleCommentChange}):null,Ie=p.getWithoutActivation("web_shopping_rec_setting").group;Ie.match("pwt")||p.v2ActivateExperiment("web_shopping_rec_setting");const Te=!["enabled","employees"].includes(Ie)||!_.isAuth||(null===(t=K.pinner)||void 0===t?void 0:t.id)!==_.id||K.is_repin||K.story_pin_data||_.shopping_rec_disabled?null:(0,c.jsx)(ue,{shoppingRecDisabled:R,onShoppingRecChange:this.handleShoppingRecChange}),Me=!!_.has_quicksave_board&&!!_.boardCount&&_.boardCount<2,De="quick_creates"===(null===(i=K.board)||void 0===i?void 0:i.layout),Re=(0,Se.Ms)(_,r);return(0,c.jsx)(v.ZP,{heading:this.props.i18n._('Edit this Pin', 'EditPinModal.ModalHeading.EditThisPin', 'Edit a previously saved pin'),accessibilityModalLabel:this.props.i18n._('Edit your previously saved pin', 'EditPinModal.ModalHeading.AccessibleLabel', 'Accessible label for edit previously saved pin modal'),size:Me?"sm":"lg",onDismiss:s,footer:(0,c.jsx)(O,{apiErrorMessage:m,shouldShowGenericUpdateError:G,onClickDeleteButton:this.onClickDeleteButton,disableDelete:!re||n,onHide:s,shouldDisableSave:L,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(Re)}),children:k||!l.isLoaded||I?(0,c.jsx)(d.kC,{alignItems:"center",justifyContent:"center",children:(0,c.jsx)(d.$j,{accessibilityLabel:this.props.i18n._('loading', 'EditPinModal.LoadingPin.Spinner', 'Accessible label for the edit pin loading icon'),show:!0})}):(0,c.jsxs)(d.xu,{display:"flex",justifyContent:Me?"center":"between",minHeight:350,paddingX:4,children:[Me?null:(0,c.jsxs)(d.xu,{column:12,mdColumn:9,children:[(0,c.jsx)(E,{board:x||K.board,canEdit:re,isOriginallyQuickCreatesBoard:De,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick,viewerId:_.id||""}),(0,c.jsx)(H,{board:x||K.board,canEdit:re,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:j,sectionName:C,currentSection:K.section}),be,Pe,we,Ae,ke,je,Ee,Te,ge&&(0,c.jsx)(le.Z,{children:(0,c.jsx)(ce,{onShoppingRecChange:this.handleShoppingRecChange,shoppingRecDisabled:R,storyPinData:K.story_pin_data})})]}),(0,c.jsx)(F,{isCarousel:$,shouldShowCarouselSliders:N,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:a,description:y,image:de})]})})}}const Be=(e,t,i)=>({field_set_key:"detailed",id:e,preserve_component_state:t,...i?{orbac_subject_id:i}:Object.freeze({})}),Le=(0,s.connect)(null,((e,t)=>({changeBoardPinCount:t=>e((0,me.B)(t)),changeUserPinCount:t=>e((0,Pe.J)(t)),completeResourceFetch:(t,i)=>e((0,g.Sr)("PinResource",Be(t.resource_response.data.id,!1,i),t)),createBoard:(t,i,n)=>e(function(e,t,i){const n={name:e,privacy:h.Z.BoardPrivacy.PUBLIC,username:t,...i?{orbac_subject_id:i}:Object.freeze({})};return e=>p.ZP.create("BoardResource",n).callCreate().then((i=>{const n=i.resource_response.data;return e(t&&(0,g.jB)("BoardsResource",(0,_.Z)(t,!1))),n}))}(t,i,n)),createSection:(i,n)=>e((0,m.Z)(i,t.i18n,n)),invalidatePinResource:(t,i)=>e((0,g.jB)("PinResource",Be(t,!0,i))),removeBoardlessPin:(t,i)=>e((0,re.Z)({feedId:t,feedType:ve.DV.BOARDLESS_PINS,itemIds:[i],itemType:"pin"})),pinMoved:(0,Ae.bindActionCreators)(Ee.S,e),updatePinNote:(t,i,n,s)=>e((0,be._)(t,i,n,s))})))(Re);function Ne(e){var t;const i=(0,a.ZP)(),{logContextEvent:n}=(0,M.v)(),o=(0,s.useSelector)((({advertiser:e})=>e)),r=null===(t=(0,je.W)())||void 0===t?void 0:t.onPinDelete,l=(0,he.Z)(),d=(0,ge.Z)(),u=(0,Se.lJ)(d,l),h=(0,pe.Z)({name:"PinResource",options:Be(e.pinId,!0,u)}),_=d.isAuth&&Boolean(o)?o.id:void 0,p=d.isAuth&&Boolean(o)&&o.owner_user_id!==d.id?o.owner_user_id:void 0,g=(0,_e.Z)(h.data);return(0,c.jsx)(Le,{...e,dispatch:(0,s.useDispatch)(),history:(0,Ie.k6)(),pinResource:h,requestContext:(0,we.B)(),i18n:i,onDelete:()=>{var t;g(),null===(t=e.onDelete)||void 0===t||t.call(e),r&&r({pinId:e.pinId})},orbacActingAs:l,advertiser_id:_,advertiserOwnerUserId:p,viewer:d,logContextEvent:n})}},957885:(e,t,i)=>{function n(e,t){return e?t._('Title too long. Make sure all cards\' titles have less than 100 characters', 'Title entered is too long while editing a carousel pin and/or one of its pins', 'Title entered is too long while editing a carousel pin and/or one of its pins'):t._('Title too long. Make sure title has less than 100 characters', 'Title entered is too long while editing a pin', 'Title entered is too long while editing a pin')}function s(e,t){return e?t._('Description too long. Make sure all cards\' descriptions have less than 500 characters', 'Description entered is too long while editing a carousel pin and/or one of its pins', 'Description entered is too long while editing a carousel pin and/or one of its pins'):t._('Description too long. Make sure description has less than 500 characters', 'Description entered is too long while editing a pin', 'Description entered is too long while editing a pin')}function o(e,t){return t._('Too many mentions. Make sure you have at most 5.', 'editPinModal.errorMessages.userMentionOverLimit', 'Too many mentions used in the description')}function r(e,t){return e?t._('Need to provide a valid URL. Make sure all cards\' links are valid', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins'):t._('Need to provide a valid URL. Make sure the link is valid', 'Invalid URL/link provided while editing a pin', 'Invalid URL/link provided while editing a pin')}i.d(t,{MM:()=>s,Y8:()=>n,bl:()=>o,qj:()=>r})},791250:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(898781),s=i(883119),o=i(785893);function r({onUpdate:e,showLabel:t=!0,value:i}){const r=(0,n.ZP)(),l=[{label:r._('Easy', 'storyboard.detailsList.field.difficulty', 'Easy difficulty rating for story pin'),value:String(1)},{label:r._('Medium', 'storyboard.detailsList.field.difficulty', 'Medium difficulty rating for story pin'),value:String(2)},{label:r._('Difficult', 'storyboard.detailsList.field.difficulty', 'Hard difficulty rating for story pin'),value:String(3)}];return(0,o.jsx)(s.kC,{alignItems:"stretch",justifyContent:"start",width:"100%",children:(0,o.jsx)(s.xu,{width:"100%",children:(0,o.jsx)(s.EI,{size:"lg",id:"servings",name:"servings",label:t?r._('Difficulty', 'storyboard.detailsList.field.difficulty', 'Header title for difficulty rating entry for story pin'):void 0,placeholder:r._('Pick a difficulty rating', 'storyboard.detailsList.field', 'Placeholder caption for difficulty rating input in story pin'),value:i,options:l,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},803405:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(667294),s=i(755742),o=i(898781),r=i(883119),l=i(785893);const a=e=>{const t=e.split("\n");t.push("");const i=[];let n,s=[];return t.forEach((e=>{const t=e.indexOf("");t>-1?(n||(n=""),s.push(e.substring(t+1).trim())):((n||s.length>0)&&i.push({heading:n,items:s}),n=e,s=[])})),i},d=e=>{let t="";return e.forEach(((i,n)=>{const{heading:s,items:o}=i;s&&(t+=s),o&&o.length>0&&(t+="\n "+o.join("\n ")),n<e.length-1&&(t+="\n\n")})),t};const c=function({header:e,helperText:t,listBlocks:i,onUpdate:c,placeholderListBlocks:u}){const h=(0,o.ZP)(),_=d(u||[{heading:h._('What you\'ll need', 'storyboard.detailsList.placeholder', 'Placeholder text header for details list of story Pin'),items:[h._('Write a bullet list of tools, materials and anything else!', 'storyboard.detailsList.placeholder', 'Placeholder text instructions for details list of story Pin'),h._('Type it up or copy and paste.', 'storyboard.detailsList.placeholder', 'Placeholder text instructions for details list of story Pin')]}]),[p,g]=(0,n.useState)(i?d(i):"");return(0,l.jsx)(r.xu,{children:(0,l.jsx)(r.Kx,{id:"storyboard-details-list",helperText:t,label:e,onChange:({value:e})=>{g(e),c(a(e))},onBlur:()=>{""===p.trim()&&g("")},onKeyDown:({event:e,value:t})=>{const{keyCode:i,target:n,shiftKey:o}=e;if(n instanceof HTMLTextAreaElement){const{selectionStart:r,selectionEnd:l}=n;if(r===l){let l=0,d=0,u="";if(i===s.Z.ENTER?"\n "!==t.substring(r-3,r)||"\n"!==t.substring(r,r+1)&&r!==t.length?o||"\n"===t.substring(r-1,r)||(l=0,u="\n "):(l=-3,u="\n"):i!==s.Z.BACKSPACE&&i!==s.Z.DELETE||("\n "===t.substring(r-3,r)?l=-3:"\n"===t.substring(r-2,r)?l=-2:"\n"===t.substring(r-1,r)&&""===t.substring(r,r+1)&&(l=-1,d=1)),0!==l||0!==d||""!==u){const i=t.substring(0,r+l)+u+t.substring(r+d);g(i);const s=r+l+u.length;setTimeout((()=>{n.selectionStart=s,n.selectionEnd=s}),10),c(a(i)),e.preventDefault()}}}},placeholder:_,rows:7,value:p})})}},201238:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(898781),s=i(349700),o=i(883119),r=i(785893);function l({onUpdate:e,showLabel:t=!0,value:i}){const l=(0,n.ZP)(),a=[];for(let n=1;n<=50;n+=1)a.push({value:String(n),label:(0,s.nk)(l.ngettext('{{ servings }} serving', '{{ servings }} servings', n, 'storyboard.detailsList.field.servings', 'Option for number of servings a story pin recipe will provide'),{servings:n}).join("")});return(0,r.jsx)(o.kC,{alignItems:"stretch",justifyContent:"start",width:"100%",children:(0,r.jsx)(o.xu,{width:"100%",position:"relative",children:(0,r.jsx)(o.EI,{size:"lg",id:"servings",name:"servings",label:t?l._('Servings', 'storyboard.detailsList.field.servings', 'Header title for serving count entry for story pin recipe'):void 0,placeholder:l._('Pick a serving size', 'storyboard.detailsList.recipe', 'Placeholder caption for servings count input in story pin recipe'),value:i,options:a,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},70715:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(667294),s=i(898781),o=i(349700),r=i(883119),l=i(785893);function a({header:e,onUpdate:t,value:i}){const a=(0,s.ZP)(),[d,c]=(0,n.useState)(i?String(Math.floor(Number.parseInt(i,10)/60)):"0"),[u,h]=(0,n.useState)(i?String(Number.parseInt(i,10)%60):"0"),_=(e,i)=>{t(String(Number.parseInt(i,10)+60*Number.parseInt(e,10)))},p=[];for(let n=0;n<=9;n+=1)p.push({value:String(n),label:(0,o.nk)(a.ngettext('{{ hours }} hour', '{{ hours }} hours', n, 'storyboard.detailsList.recipe', 'Option for number of hours a story pin recipe will take'),{hours:n}).join("")});const g=[];for(let n=0;n<60;n+=1)g.push({value:String(n),label:(0,o.nk)(a.ngettext('{{ minutes }} minute', '{{ minutes }} minutes', n, 'storyboard.detailsList.recipe', 'Option for number of minutes a story pin recipe will take'),{minutes:n}).join("")});return(0,l.jsxs)(r.kC,{alignItems:"end",justifyContent:"start",width:"100%",children:[(0,l.jsx)(r.xu,{width:"50%",marginEnd:2,children:(0,l.jsx)(r.EI,{size:"lg",id:"hours",name:"hours",label:e,placeholder:a._('Hours', 'storyboard.detailsList.recipe', 'Placeholder caption for hours input in story pin recipe cooktime'),value:d,options:p,onChange:({value:e})=>{Number.isNaN(e)||(c(e),_(e,u))}})}),(0,l.jsx)(r.xu,{width:"50%",marginStart:2,children:(0,l.jsx)(r.EI,{size:"lg",id:"minutes",name:"minutes",placeholder:a._('Minutes', 'storyboard.detailsList.recipe', 'Placeholder caption for minutes input in story pin recipe cooktime'),value:u,options:g,onChange:({value:e})=>{Number.isNaN(e)||(h(e),_(d,e))}})})]})}},952058:(e,t,i)=>{i.d(t,{CH:()=>s,Fe:()=>r,_i:()=>o});const n=[0,2,1];function s(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map((e=>{const{heading:t,blocks:i}=e;return{heading:t,blocks:(null!=i?i:[]).map((e=>({text:e.text?e.text:"",type:9}))),type:7}})):[];return{key_value_blocks:i&&i.length>0?i.map((e=>({category_type:e.category_type,type:8,value:e.value}))):[],list_blocks:n}}function o(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map((e=>{const{heading:t,blocks:i}=e;return{heading:t,items:(null!=i?i:[]).map((e=>e.text?e.text:""))}})):[];return{keyValueBlocks:i&&i.length>0?i.reduce(((e,t)=>{const{category_type:i,value:n}=t;return e[null!=i?i:""]=n,e}),{}):{},listBlocks:n}}function r(e){const{keyValueBlocks:t,listBlocks:i}=e;if(!t&&!i)return null;return{list_blocks:i?i.map((e=>{const{heading:t,items:i}=e;let n=[];return i&&(n=i.map((e=>({text:e,type:9})))),{blocks:n,heading:t,type:7}})):[],key_value_blocks:(t?Object.keys(t).map((e=>{const i=t[e],s=Number.parseInt(e,10),o=n.indexOf(s)>-1&&i===Number.parseInt(i,10).toString();return i&&o?{value:i,category_type:s,type:8}:null})):[]).filter(Boolean)}}},91580:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(667294),s=i(966338),o=i(914166),r=i(708206),l=i(407043),a=i(946984),d=i(785893);const c=(0,r.compose)((0,s.connect)((({pins:e},{pinId:t,carouselSlotCurrentIndex:i})=>{const{carousel_data:n}=e&&t&&e[t]||{},{index:s}=n||{};return void 0!==i?{carouselSlotCurrentIndex:s||i||0}:{}})),(function(e){return function(t){const{logContextEvent:i}=(0,l.v)(),[s,r]=(0,n.useState)(!1),c=(0,a.Z)({shouldStopEventPropagation:!1}),{pinId:u,onDelete:h,onSubmit:_,carouselSlotCurrentIndex:p}=t;return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(e,{...t,handlePinEditButtonClick:c((e=>{e&&e.stopPropagation();const{component:n,onToggleModal:s}=t;s&&s(!0),i({event_type:101,element:3,...n?{component:n}:Object.freeze({})}),r(!0)}))}),s&&(0,d.jsx)(o.ZP,{carouselSlotCurrentIndex:p,onDelete:h,onHide:()=>{r(!1),t.onToggleModal&&t.onToggleModal(!1)},onSubmit:_,pinId:u})]})}}))},865615:(e,t,i)=>{i.d(t,{_:()=>s});var n=i(6637);function s(e,t,i,s){return async o=>{const r=n.ZP.create("ApiResource",{url:`/v3/pins/${e}/notes/`,data:{pin_note_content:i,...s?{orbac_subject_id:s}:Object.freeze({})}});let l;l=i?t?await r.callUpdate():await r.callCreate():await r.callDelete();const{resource_response:a}=l;o(function(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}(e,null==a?void 0:a.data))}}},782534:(e,t,i)=>{i.d(t,{Z:()=>r,k:()=>s.k});var n=i(780280),s=i(451820),o=i(785893);const r=({dateFormatType:e,useUTC:t=!0,value:i})=>(0,o.jsx)(n.LC,{children:n=>(0,s.Z)(n.locale,i,e,t)})},969759:(e,t,i)=>{i.d(t,{Z:()=>n});const n=(e,t)=>{const i=new Date(e);return i.setDate(e.getDate()+t),i}},451820:(e,t,i)=>{i.d(t,{Z:()=>s,k:()=>n});const n={LONG:"long",YEAR:"year",WEEKDAY_DATE:"weekday_date",WEEKDAY_DATE_TIME_TIMEZONE:"weekday_date_time_timezone",SHORT_WEEKDAY_DATE:"short_weekday_date",LONG_MONTH_YEAR:"long_month_year",NUMERIC:"numeric",MONTH_DAY:"month_day",SHORT_MONTH:"short_month",SHORT_MONTH_DAY:"short_month_day",DAY:"day",YEAR_SHORT_MONTH_DAY:"year_short_month_day",YEAR_SHORT_MONTH_DAY_HOUR:"year_short_month_day_hour",TIME:"time",TIME_TIMEZONE:"time_timezone",HOUR:"hour"};function s(e,t,i,s=!0){const o=function(e){switch(e){case n.YEAR:return{year:"numeric"};case n.LONG:return{year:"numeric",month:"long",day:"numeric"};case n.NUMERIC:return{year:"numeric",month:"numeric",day:"numeric"};case n.WEEKDAY_DATE:return{weekday:"long",month:"long",day:"numeric",year:"numeric"};case n.SHORT_WEEKDAY_DATE:return{weekday:"short",month:"numeric",day:"numeric"};case n.WEEKDAY_DATE_TIME_TIMEZONE:return{weekday:"short",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"};case n.MONTH_DAY:return{month:"long",day:"numeric"};case n.SHORT_MONTH:return{month:"short"};case n.SHORT_MONTH_DAY:return{month:"short",day:"numeric"};case n.DAY:return{day:"numeric"};case n.LONG_MONTH_YEAR:return{month:"long",year:"numeric"};case n.YEAR_SHORT_MONTH_DAY:return{year:"numeric",month:"short",day:"numeric"};case n.YEAR_SHORT_MONTH_DAY_HOUR:return{month:"short",year:"numeric",day:"numeric",hour:"numeric"};case n.TIME:return{hour:"numeric",minute:"2-digit"};case n.TIME_TIMEZONE:return{hour:"numeric",minute:"2-digit",timeZoneName:"short"};case n.HOUR:return{hour:"numeric"};default:throw new Error('invalid dateFormatType "'+e+'"')}}(i);s&&(o.timeZone="UTC");return new Intl.DateTimeFormat(e,o).format(t)}},224496:(e,t,i)=>{i.d(t,{Cc:()=>d,RR:()=>n,YB:()=>s,YL:()=>r,h8:()=>a,pE:()=>l,yR:()=>o});const n="0.8.0",s=9/16,o=8,r=10;function l(e,t=1){return{x:(null!=e?e:24)/5,y:(null!=e?e:24)*(t-1)}}const a={COMMENT_REPLY_STICKER:"story_pin_comment_reply_block",GENERIC_STICKER:"story_pin_generic_interactive_sticker_block",HEADING:"story_pin_heading_block",IMAGE:"story_pin_image_block",INGREDIENT:"story_pin_ingredient_block",LINK:"story_pin_link_block",MENTION_STICKER:"story_pin_mention_sticker_block",MUSIC:"story_pin_music_block",PARAGRAPH:"story_pin_paragraph_block",PRODUCT_STICKER:"story_pin_product_sticker_block",SUPPLY:"story_pin_supply_block",VIDEO:"story_pin_video_block",VTO_MAKEUP_STICKER:"story_pin_virtual_try_on_makeup_sticker_block"},d={alignment:1,hex_color:"#111111",highlight_color:"#FFFFFF",vertical_alignment:1,font:{default_size:28,id:"1",key:"Graphik-Regular.otf",letter_spacing:-.4,line_height:1.25,name:"Teaspoon",url:"https://s.pinimg.com/story_pins/fonts/Graphik-Regular.otf"},font_size:28}},700314:(e,t,i)=>{function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{B:()=>o,n:()=>s});const s=(e,t)=>{const i=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(null==e||!e.match(i)||null==t||!t.match(i))return null;const n=null==e?void 0:e.split("."),s=null==t?void 0:t.split("."),o=Math.max((null!=n?n:"").length,(null!=s?s:"").length);for(let a=0;a<o;a+=1){var r,l;const e=a<(null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0)?parseInt(null==n?void 0:n[a],10):0,t=a<(null!==(l=null==s?void 0:s.length)&&void 0!==l?l:0)?parseInt(null==s?void 0:s[a],10):0;if(e<t)return-1;if(e>t)return 1}return 0};class o{constructor(e,t,i){n(this,"start",Date.now()),n(this,"paused",!1),this.onProgress=e,this.onComplete=t,this.duration=i,this.remaining=i,"undefined"!=typeof window&&(this.intervalId=window.setInterval((()=>{const e=this.paused?this.duration-this.remaining:this.duration-this.remaining+(Date.now()-this.start);this.onProgress(e/this.duration)}),500),this.resume())}currentTime(){return this.duration-this.remaining}pause(){this.paused=!0,window.clearTimeout(this.timerId),this.remaining-=Date.now()-this.start;const e=this.duration-this.remaining;this.onProgress(e/this.duration)}resume(){this.paused=!1,this.start=Date.now(),window.clearTimeout(this.timerId),this.timerId=window.setTimeout(this.onComplete,this.remaining)}clear(){window.clearTimeout(this.timerId),window.clearInterval(this.intervalId)}}},134906:(e,t,i)=>{i.d(t,{Bh:()=>c,CU:()=>r,FU:()=>S,G$:()=>f,GT:()=>l,Gy:()=>g,J_:()=>P,Jx:()=>_,MZ:()=>m,VC:()=>h,VG:()=>a,ZA:()=>d,Zt:()=>p,a3:()=>w,aH:()=>o,nw:()=>v,oR:()=>y,qA:()=>u,qp:()=>j,sG:()=>x,vd:()=>C,xk:()=>b});var n=i(89254);const s=e=>{const t={"":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":" "},i=String(e).split("");return i.forEach(((e,n)=>{const s=t[e];s&&(i[n]=s)})),i.join("")};function o(e){return function(t,i){const n=[];t&&/\S/.test(t)||n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}const r=new RegExp(["(^[-!#$%&'*+/=?^_`{}|~0-9A-Z]+(\\.[-!#$%&'*+/=?^_`{}|~0-9A-Z]+)*",'|^"([\\001-\\010\\013\\014\\016-\\037!#-\\[\\]-\\177]|\\\\[\\001-\\011\\013\\014\\016-\\177])*"',")@((?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,20}$)","|\\[(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}\\]$"].join(""),"i");function l(e){return function(t,i){const n=[];(t=t&&t.trim())&&!t.match(r)&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function a(e){return function(t,i){const n=[];(t=t&&t.trim())&&!t.match(/^[^0-9].*$/)&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function d(e){return function(t,i){const n=[];t&&(Number.isNaN(parseInt(t))&&n.push(e.invalidAgeString),e.ageTooShortString&&t<10&&n.push(e.ageTooShortString),t<=0||t>=300?n.push(e.invalidAgeString):e.checkUnderAgeWithString&&t<13&&n.push(e.checkUnderAgeWithString));const s={errors:n,warnings:[]};return i&&i(s),s}}function c(e){return function(t,i){const n=(t=t&&t.trim()).replace(/[\(\)\+\-\. ]/g,""),s=[],o=!1!==e.checkLength&&n.length<7;!t||t.match(/^(\(?\+?[0-9]*\)?)?[0-9_\- \.\(\)]*$/g)&&!o||s.push(e.message);const r={errors:s,warnings:[]};return i&&i(r),r}}function u(e){return function(t,i){const n=/^\d+$/,o=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=s(t))&&!t.match(n)&&o.push(e.message));const r={errors:o,warnings:[]};return i&&i(r),r}}function h(e){return function(t,i){const n=/^[\d\ -]+$/,o=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=s(t))&&!t.match(n)&&o.push(e.message));const r={errors:o,warnings:[]};return i&&i(r),r}}function _(e){return function(t,i){const n=[];t&&!t.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi)&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function p(e){return function(t,i){const s=[];if(t)try{const i=(0,n.Z)(t);i&&i.protocol&&("http"!==i.protocol||"localhost"===i.hostname)||s.push(e.message)}catch(r){s.push(e.message)}const o={errors:s,warnings:[]};return i&&i(o),o}}function g(e){return function(t,i){const n=[];(e.should_trim||!1)&&(t=t&&t.trim());const s=t.length;e.min&&s<e.min?n.push(e.minErrorString):e.max&&s>e.max&&n.push(e.maxErrorString);const o={errors:n,warnings:[]};return i&&i(o),o}}function m(e){return function(t,i){const n=!e.checkExclusion,s=e.substrings,o=[];(n&&!s.some((e=>t.includes(e)))||!n&&s.some((e=>t.includes(e))))&&o.push(e.message);const r={errors:o,warnings:[]};return i&&i(r),r}}function x(e){return function(t,i){const n=[];t!==(e&&e.targetValue)&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function f(e){return function(t,i){t&&(t=parseFloat(t));const n=[];t<=e.value&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function v(e){return function(t,i){t&&(t=parseFloat(t));const n=[];t<e.value&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function y(e){return function(t,i){const n=[];/^[\040-\176]*$/.test(t)||n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function b(e){return function(t,i){let n=2;if(e.hasFractionalCents)n=3;else if(e.currencyCode){const{maximumFractionDigits:t}=new Intl.NumberFormat(void 0,{style:"currency",currency:e.currencyCode}).resolvedOptions();n=t}const s=new RegExp(n?`^\\d*(\\.\\d{1,${n}})?$`:"^\\d*$"),o=[];"number"==typeof t&&(t=t.toString()),t&&!t.match(s)&&(t=t&&t.trim(),o.push(e.message));const r={errors:o,warnings:[]};return i&&i(r),r}}function P(e){return function(t,i){t=t&&t.trim();const n=[],s=new Date(t);t&&!s.getTime()&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function j(e){return function(t,i){const n=[];(t=t&&t.trim())&&!t.match(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/)&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function C(e){return function(t,i){const n=[];e.pattern.test(t)||n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function S(e,t){const i=e.map((e=>e(t).errors));return[].concat(...i)}function w(e,t){let i="";return t.some((t=>{const n=t(e);return n.errors.length>0&&(i=n.errors[0],!0)})),i}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/78018-b1bb0c56862b01fe.mjs.map